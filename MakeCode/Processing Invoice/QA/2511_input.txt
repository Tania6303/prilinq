[
    {
        "input": [
            {
                "name": "learned_config",
                "value": {
                    "status": "success",
                    "supplier_id": "2511",
                    "supplier_name": "פלסאון בע\"מ",
                    "vendor_tax_id_reference": "512865254",
                    "supplier_phone": "073-2333733",
                    "supplier_email": "",
                    "json_files_analyzed": 1,
                    "templates_detected": 1,
                    "config": {
                        "supplier_config": {
                            "supplier_code": "2511",
                            "supplier_name": "פלסאון בע\"מ",
                            "vendor_tax_id_reference": "512865254"
                        },
                        "structure": [
                            {
                                "has_import": false,
                                "has_purchase_orders": false,
                                "has_doc": true,
                                "has_date_range": false,
                                "has_budcode": false,
                                "has_pdaccname": false,
                                "inventory_management": "managed_inventory",
                                "debit_type": "D"
                            }
                        ],
                        "rules": {
                            "invoice_date_format": "DD/MM/YY",
                            "doc_variation": "תעודה אחת (DOCNO) או מרובות (PIVDOC_SUBFORM) - שניהם בתבנית",
                            "validation_data": {
                                "TOTQUANT": 1208
                            },
                            "critical_patterns": {
                                "vehicle_rules": {},
                                "partname_rules": {}
                            }
                        },
                        "document_types": [
                            {
                                "type": "חשבונית עם תעודות ללא פירוט",
                                "accnames": [
                                    "63001"
                                ]
                            }
                        ]
                    },
                    "template": {
                        "PINVOICES": [
                            {
                                "SUPNAME": "2511",
                                "CODE": "ש\"ח",
                                "DEBIT": "D",
                                "IVDATE": "25/10/25",
                                "BOOKNUM": "258001605",
                                "PIVDOC_SUBFORM": [
                                    {
                                        "DOCNO": "",
                                        "BOOKNUM": ""
                                    }
                                ]
                            }
                        ],
                        "document_types_count": 1
                    },
                    "recommended_samples": {
                        "samples": [
                            {
                                "sample_ivnum": "25067861",
                                "sample_booknum": "258001605",
                                "sample_impfnum": "",
                                "sample_supname": "2511"
                            }
                        ]
                    }
                }
            },
            {
                "name": "docs_list",
                "value": {
                    "list_of_docs": [
                        "[{\"DOCNO\":\"25026831\",\"BOOKNUM\":\"108367755\",\"TOTQUANT\":120},{\"DOCNO\":\"25026832\",\"BOOKNUM\":\"108367753\",\"TOTQUANT\":448},{\"DOCNO\":\"25026849\",\"BOOKNUM\":\"108379736\",\"TOTQUANT\":40},{\"DOCNO\":\"25026850\",\"BOOKNUM\":\"108379734\",\"TOTQUANT\":600}]"
                    ],
                    "DOC_YES_NO": "Y"
                }
            },
            {
                "name": "import_files",
                "value": {
                    "IMPFILES": [
                        ""
                    ]
                }
            },
            {
                "name": "AZURE_RESULT",
                "value": {
                    "structure": {
                        "docType": "string",
                        "fields": {
                            "CustomerAddress": "string",
                            "CustomerAddress_houseNumber": "string",
                            "CustomerAddress_road": "string",
                            "CustomerAddress_streetAddress": "string",
                            "CustomerAddress_house": "string",
                            "CustomerAddressRecipient": "string",
                            "CustomerName": "string",
                            "CustomerTaxId": "string",
                            "DueDate": "YYYY-MM-DD",
                            "InvoiceDate": "YYYY-MM-DD",
                            "InvoiceId": "string",
                            "InvoiceTotal_amount": "number",
                            "InvoiceTotal_currency": "string",
                            "PaymentTerm": "string",
                            "SubTotal_amount": "number",
                            "SubTotal_currency": "string",
                            "TotalTax_amount": "number",
                            "TotalTax_currency": "string",
                            "VendorName": "string",
                            "VendorTel": "string",
                            "VendorFax": "string",
                            "CustomerTel": "string",
                            "VendorEmail": "string",
                            "UnidentifiedNumbers": [
                                "object"
                            ]
                        },
                        "Items": [
                            {
                                "Amount_amount": "number",
                                "Amount_currency": "string",
                                "Description": "string",
                                "ProductCode": "string",
                                "Quantity": "number",
                                "Unit": "string",
                                "UnitPrice_amount": "number",
                                "UnitPrice_currency": "string"
                            }
                        ]
                    },
                    "data": {
                        "docType": "invoice",
                        "fields": {
                            "CustomerAddress": "הקטיף 11\nהקטיף 11\nפארק תעשיות עמק חפר 3877701\nפארק תעשיות עמק חפר 3877701",
                            "CustomerAddress_houseNumber": "11",
                            "CustomerAddress_road": "הקטיף",
                            "CustomerAddress_streetAddress": "11 הקטיף",
                            "CustomerAddress_house": "פארק תעשיות עמק חפר 3877701\nפארק תעשיות עמק חפר 3877701",
                            "CustomerAddressRecipient": "ט.פ.י פל-ים בע״מ\nט.פ.י פל-ים בע״מ",
                            "CustomerName": "ט.פ.י פל-ים בע״מ\nט.פ.י פל-ים בע״מ",
                            "CustomerTaxId": "513327064",
                            "DueDate": "2026-02-28",
                            "InvoiceDate": "2025-10-26",
                            "InvoiceId": "258001605",
                            "InvoiceTotal_amount": 149671.2,
                            "InvoiceTotal_currency": "ILS",
                            "Items": [
                                {
                                    "Amount_amount": 12600,
                                    "Amount_currency": "ILS",
                                    "Description": "מיכל דואון לבן מורכב",
                                    "ProductCode": "33008600",
                                    "Quantity": 120,
                                    "Unit": "יחי",
                                    "UnitPrice_amount": 105,
                                    "UnitPrice_currency": "ILS"
                                },
                                {
                                    "Amount_amount": 47040,
                                    "Amount_currency": "ILS",
                                    "Description": "מיכל קלסאון לבן מורכב",
                                    "ProductCode": "33007400",
                                    "Quantity": 448,
                                    "Unit": "יחי",
                                    "UnitPrice_amount": 105,
                                    "UnitPrice_currency": "ILS"
                                },
                                {
                                    "Amount_amount": 63000,
                                    "Amount_currency": "ILS",
                                    "Description": "מיכל דואון לבן מורכב",
                                    "ProductCode": "33008600",
                                    "Quantity": 600,
                                    "Unit": "יחי",
                                    "UnitPrice_amount": 105,
                                    "UnitPrice_currency": "ILS"
                                },
                                {
                                    "Amount_amount": 4200,
                                    "Amount_currency": "ILS",
                                    "Description": "מיכל דואון לבן מורכב",
                                    "ProductCode": "33008600",
                                    "Quantity": 40,
                                    "Unit": "יחי",
                                    "UnitPrice_amount": 105,
                                    "UnitPrice_currency": "ILS"
                                }
                            ],
                            "PaymentTerm": "שוטף + 120",
                            "SubTotal_amount": 126840,
                            "SubTotal_currency": "ILS",
                            "TotalTax_amount": 22831.2,
                            "TotalTax_currency": "ILS",
                            "VendorName": "PLASSON®",
                            "VendorTel": "04-6394721",
                            "VendorFax": "04-6394816",
                            "CustomerTel": "521 20251028",
                            "VendorEmail": "Yaels@plasson.co.il",
                            "UnidentifiedNumbers": [
                                {
                                    "label": "לפירעון עד",
                                    "value": "28/02/2026"
                                },
                                {
                                    "label": "הקמת הזמנה",
                                    "value": "Moshe, Megi"
                                },
                                {
                                    "label": "הפקת חשבונית",
                                    "value": "Sharett, Yael"
                                },
                                {
                                    "label": "מספר זיהוי (VIN)",
                                    "value": "20251028104848545",
                                    "context": "08367755 מס׳ הקצאה: 301086521 20251028104848545 הערות: מס׳ מק״ט לקוח מק״ט פלס"
                                }
                            ]
                        }
                    },
                    "metadata": {
                        "modelId": "prebuilt-invoice",
                        "totalFields": 25,
                        "uniqueDataFound": 4
                    },
                    "status": "success"
                }
            },
            {
                "name": "AZURE_TEXT",
                "value": "{\"status\":\"succeeded\",\"createdDateTime\":\"2025-10-31T12:01:32Z\",\"lastUpdatedDateTime\":\"2025-10-31T12:01:35Z\",\"analyzeResult\":{\"apiVersion\":\"2023-07-31\",\"modelId\":\"prebuilt-invoice\",\"stringIndexType\":\"textElements\",\"content\":\"מסמך ממוחשב\\nחתום דיגיטלית ומאושר\\nעל ידי גורם מאשר\\npersonal\\nפלסאון בע״מ | מס׳ עוסק מורשה 512865254 | פטור מניכוי מס הכנסה במקור לפי אישור פקיד שומה חיפה\\nמעגן מיכאל, ד.נ. מנשה 3780500 | טלפון: 04-6394721, פקס: 04-6394816 | www.plasson.co.il | Yaels@plasson.co.il\\n-\\nPLASSON®\\nעמוד 1 מתוך 1\\nחשבונית מס מספר: 258001605\\nמקור\\nמסמך ממוחשב\\nלכבוד:\\nיעד למשלוח:\\nתאריך: 26/10/2025\\nט.פ.י פל-ים בע״מ\\nט.פ.י פל-ים בע״מ\\nמס׳ לקוח: 1340 ע.מ. לקוח: 513327064\\nהקטיף 11\\nהקטיף 11\\nמס׳ הזמנת לקוח: 2501005923\\nפארק תעשיות עמק חפר 3877701\\nפארק תעשיות עמק חפר 3877701\\nמס׳ הזמנת פלסאון: 60000013\\nמס׳ תעודת משלוח: 108379736, 108379734,\\n108367753 ,108367755\\nמס׳ הקצאה: 301086521 20251028104848545\\nהערות:\\nמס׳\\nמק״ט לקוח\\nמק״ט פלסאון\\nתיאור\\nיח׳\\nכמות\\nמחיר\\nסכום\\nאחוז\\nסכום\\nמידה\\nיח׳\\nברוטו\\nהנחה\\nנטו\\nב- ש״ח\\nב-ש״ח\\nב-ש״ח\\n1\\n33008600\\nמיכל דואון לבן מורכב\\nיחי\\n120\\n105.00\\n12,600.00\\n0.00\\n12,600.00\\n2\\n33007400\\nמיכל קלסאון לבן מורכב\\nיחי\\n448\\n105.00\\n47,040.00\\n0.00\\n47,040.00\\n3\\n33008600\\nמיכל דואון לבן מורכב\\nיחי\\n600\\n105.00\\n63,000.00\\n0.00\\n63,000.00\\n4\\n33008600\\nמיכל דואון לבן מורכב\\nיחי\\n40\\n105.00\\n4,200.00\\n0.00\\n4,200.00\\nלפירעון עד: 28/02/2026\\nסה״כ ברוטו בש״ח:\\n126,840.00\\nתנאי תשלום: שוטף + 120\\nהקמת הזמנה: Moshe, Megi\\nסה״כ נטו:\\n126,840.00\\nהפקת חשבונית: Sharett, Yael\\nמע״מ 18%:\\n22,831.20\\nפלסאון בע״מ\\nסה״כ לתשלום בש״ח:\\n149,671.20\",\"pages\":[{\"pageNumber\":1,\"angle\":0,\"width\":11.6806,\"height\":8.2639,\"unit\":\"inch\",\"words\":[{\"content\":\"מסמך\",\"polygon\":[0.4005,0.1572,0.5779,0.1572,0.5729,0.2332,0.3954,0.2332],\"confidence\":0.98,\"span\":{\"offset\":0,\"length\":4}},{\"content\":\"ממוחשב\",\"polygon\":[0.1217,0.1572,0.3853,0.1572,0.3802,0.2332,0.1217,0.2332],\"confidence\":0.982,\"span\":{\"offset\":5,\"length\":6}},{\"content\":\"חתום\",\"polygon\":[0.4563,0.2434,0.5678,0.2484,0.5678,0.3042,0.4563,0.2991],\"confidence\":0.976,\"span\":{\"offset\":12,\"length\":4}},{\"content\":\"דיגיטלית\",\"polygon\":[0.2788,0.2434,0.4461,0.2434,0.4461,0.2991,0.2788,0.2991],\"confidence\":0.961,\"span\":{\"offset\":17,\"length\":8}},{\"content\":\"ומאושר\",\"polygon\":[0.1166,0.2383,0.2687,0.2434,0.2687,0.2991,0.1217,0.2991],\"confidence\":0.976,\"span\":{\"offset\":26,\"length\":6}},{\"content\":\"על\",\"polygon\":[0.4613,0.3042,0.5171,0.3042,0.512,0.3549,0.4613,0.3549],\"confidence\":0.982,\"span\":{\"offset\":33,\"length\":2}},{\"content\":\"ידי\",\"polygon\":[0.3904,0.3042,0.4512,0.3042,0.4512,0.3549,0.3904,0.3549],\"confidence\":0.982,\"span\":{\"offset\":36,\"length\":3}},{\"content\":\"גורם\",\"polygon\":[0.2991,0.3042,0.3802,0.3042,0.3802,0.3549,0.3042,0.3549],\"confidence\":0.982,\"span\":{\"offset\":40,\"length\":4}},{\"content\":\"מאשר\",\"polygon\":[0.1673,0.3042,0.289,0.3042,0.294,0.3549,0.1724,0.3549],\"confidence\":0.982,\"span\":{\"offset\":45,\"length\":4}},{\"content\":\"personal\",\"polygon\":[0.076,0.4157,0.4411,0.4005,0.4461,0.4867,0.0811,0.4867],\"confidence\":0.767,\"span\":{\"offset\":50,\"length\":8}},{\"content\":\"פלסאון\",\"polygon\":[9.5766,0.5678,9.9214,0.5678,9.9214,0.6946,9.5766,0.6946],\"confidence\":0.961,\"span\":{\"offset\":59,\"length\":6}},{\"content\":\"בע״מ\",\"polygon\":[9.3637,0.5678,9.5513,0.5678,9.5513,0.6946,9.3637,0.6946],\"confidence\":0.954,\"span\":{\"offset\":66,\"length\":4}},{\"content\":\"|\",\"polygon\":[9.2471,0.5678,9.3232,0.5678,9.3232,0.6946,9.2471,0.6946],\"confidence\":0.92,\"span\":{\"offset\":71,\"length\":1}},{\"content\":\"מס׳\",\"polygon\":[9.0342,0.5678,9.2218,0.5678,9.2218,0.6946,9.0342,0.6946],\"confidence\":0.812,\"span\":{\"offset\":73,\"length\":3}},{\"content\":\"עוסק\",\"polygon\":[8.8314,0.5678,9.0088,0.5678,9.0088,0.6946,8.8314,0.6946],\"confidence\":0.98,\"span\":{\"offset\":77,\"length\":4}},{\"content\":\"מורשה\",\"polygon\":[8.5374,0.5678,8.806,0.5678,8.806,0.6946,8.5323,0.6946],\"confidence\":0.982,\"span\":{\"offset\":82,\"length\":5}},{\"content\":\"512865254\",\"polygon\":[8.0507,0.5678,8.512,0.5678,8.512,0.6946,8.0507,0.6946],\"confidence\":0.92,\"span\":{\"offset\":88,\"length\":9}},{\"content\":\"|\",\"polygon\":[7.9594,0.5678,8.0253,0.5678,8.0253,0.6946,7.9594,0.6946],\"confidence\":0.875,\"span\":{\"offset\":98,\"length\":1}},{\"content\":\"פטור\",\"polygon\":[7.7313,0.5678,7.9391,0.5678,7.9341,0.6946,7.7313,0.6946],\"confidence\":0.955,\"span\":{\"offset\":100,\"length\":4}},{\"content\":\"מניכוי\",\"polygon\":[7.4524,0.5678,7.7059,0.5678,7.7059,0.6946,7.4524,0.6946],\"confidence\":0.962,\"span\":{\"offset\":105,\"length\":6}},{\"content\":\"מס\",\"polygon\":[7.3308,0.5678,7.4271,0.5678,7.4271,0.6946,7.3308,0.6946],\"confidence\":0.961,\"span\":{\"offset\":112,\"length\":2}},{\"content\":\"הכנסה\",\"polygon\":[7.0367,0.5678,7.3054,0.5678,7.3054,0.6946,7.0367,0.6946],\"confidence\":0.976,\"span\":{\"offset\":115,\"length\":5}},{\"content\":\"במקור\",\"polygon\":[6.7427,0.5729,7.0114,0.5678,7.0114,0.6946,6.7376,0.6946],\"confidence\":0.98,\"span\":{\"offset\":121,\"length\":5}},{\"content\":\"לפי\",\"polygon\":[6.55,0.5729,6.7173,0.5729,6.7173,0.6946,6.55,0.6946],\"confidence\":0.982,\"span\":{\"offset\":127,\"length\":3}},{\"content\":\"אישור\",\"polygon\":[6.3118,0.5729,6.5247,0.5729,6.5247,0.6946,6.3118,0.6946],\"confidence\":0.98,\"span\":{\"offset\":131,\"length\":5}},{\"content\":\"פקיד\",\"polygon\":[6.0836,0.5729,6.2915,0.5729,6.2915,0.6946,6.0836,0.6946],\"confidence\":0.978,\"span\":{\"offset\":137,\"length\":4}},{\"content\":\"שומה\",\"polygon\":[5.8453,0.5729,6.0583,0.5729,6.0583,0.6946,5.8453,0.6946],\"confidence\":0.982,\"span\":{\"offset\":142,\"length\":4}},{\"content\":\"חיפה\",\"polygon\":[5.6071,0.5729,5.82,0.5729,5.82,0.6946,5.6071,0.6946],\"confidence\":0.98,\"span\":{\"offset\":147,\"length\":4}},{\"content\":\"מעגן\",\"polygon\":[9.6882,0.7098,9.9163,0.7149,9.9214,0.8365,9.6882,0.8365],\"confidence\":0.961,\"span\":{\"offset\":152,\"length\":4}},{\"content\":\"מיכאל,\",\"polygon\":[9.3789,0.7098,9.6628,0.7098,9.6679,0.8365,9.3789,0.8365],\"confidence\":0.954,\"span\":{\"offset\":157,\"length\":6}},{\"content\":\"ד.נ.\",\"polygon\":[9.2167,0.7098,9.3536,0.7098,9.3586,0.8365,9.2218,0.8365],\"confidence\":0.98,\"span\":{\"offset\":164,\"length\":4}},{\"content\":\"מנשה\",\"polygon\":[8.9936,0.7098,9.1964,0.7098,9.1964,0.8365,8.9987,0.8365],\"confidence\":0.966,\"span\":{\"offset\":169,\"length\":4}},{\"content\":\"3780500\",\"polygon\":[8.6134,0.7098,8.9733,0.7098,8.9733,0.8365,8.6185,0.8365],\"confidence\":0.961,\"span\":{\"offset\":174,\"length\":7}},{\"content\":\"|\",\"polygon\":[8.5171,0.7098,8.588,0.7098,8.5931,0.8365,8.5221,0.8365],\"confidence\":0.852,\"span\":{\"offset\":182,\"length\":1}},{\"content\":\"טלפון:\",\"polygon\":[8.218,0.7098,8.4968,0.7098,8.4968,0.8365,8.218,0.8365],\"confidence\":0.935,\"span\":{\"offset\":184,\"length\":6}},{\"content\":\"04-6394721,\",\"polygon\":[7.6907,0.7098,8.1926,0.7098,8.1977,0.8365,7.6958,0.8365],\"confidence\":0.893,\"span\":{\"offset\":191,\"length\":11}},{\"content\":\"פקס:\",\"polygon\":[7.4524,0.7149,7.6654,0.7098,7.6704,0.8365,7.4575,0.8365],\"confidence\":0.968,\"span\":{\"offset\":203,\"length\":4}},{\"content\":\"04-6394816\",\"polygon\":[6.9759,0.7149,7.4271,0.7149,7.4322,0.8365,6.981,0.8365],\"confidence\":0.954,\"span\":{\"offset\":208,\"length\":10}},{\"content\":\"|\",\"polygon\":[6.8897,0.7149,6.9505,0.7149,6.9556,0.8365,6.8897,0.8365],\"confidence\":0.95,\"span\":{\"offset\":219,\"length\":1}},{\"content\":\"www.plasson.co.il\",\"polygon\":[5.313,0.725,6.0076,0.7199,6.0076,0.8365,5.3181,0.8315],\"confidence\":0.861,\"span\":{\"offset\":221,\"length\":17}},{\"content\":\"|\",\"polygon\":[6.0279,0.7199,6.0836,0.7199,6.0887,0.8365,6.0329,0.8365],\"confidence\":0.961,\"span\":{\"offset\":239,\"length\":1}},{\"content\":\"Yaels@plasson.co.il\",\"polygon\":[6.109,0.7199,6.8644,0.7149,6.8694,0.8365,6.114,0.8365],\"confidence\":0.847,\"span\":{\"offset\":241,\"length\":19}},{\"content\":\"-\",\"polygon\":[3.3308,0.6388,3.4778,0.6337,3.4829,0.9379,3.3359,0.943],\"confidence\":0.866,\"span\":{\"offset\":261,\"length\":1}},{\"content\":\"PLASSON®\",\"polygon\":[1.1559,0.5678,2.1495,0.5628,2.1546,0.7149,1.1559,0.7453],\"confidence\":0.892,\"span\":{\"offset\":263,\"length\":8}},{\"content\":\"עמוד\",\"polygon\":[1.6578,1.3486,1.9468,1.3486,1.9468,1.526,1.6578,1.526],\"confidence\":0.982,\"span\":{\"offset\":272,\"length\":4}},{\"content\":\"1\",\"polygon\":[1.531,1.3486,1.6223,1.3486,1.6223,1.521,1.531,1.521],\"confidence\":0.982,\"span\":{\"offset\":277,\"length\":1}},{\"content\":\"מתוך\",\"polygon\":[1.2167,1.3486,1.4956,1.3435,1.4956,1.521,1.2167,1.521],\"confidence\":0.982,\"span\":{\"offset\":279,\"length\":4}},{\"content\":\"1\",\"polygon\":[1.09,1.3486,1.1762,1.3486,1.1762,1.521,1.09,1.521],\"confidence\":0.982,\"span\":{\"offset\":284,\"length\":1}},{\"content\":\"חשבונית\",\"polygon\":[6.1546,1.5919,6.7478,1.597,6.7478,1.7795,6.1495,1.7795],\"confidence\":0.96,\"span\":{\"offset\":286,\"length\":7}},{\"content\":\"מס\",\"polygon\":[5.8859,1.5919,6.0988,1.5919,6.0938,1.7795,5.8808,1.7795],\"confidence\":0.982,\"span\":{\"offset\":294,\"length\":2}},{\"content\":\"מספר:\",\"polygon\":[5.3789,1.5869,5.8504,1.5919,5.8453,1.7795,5.3739,1.7745],\"confidence\":0.982,\"span\":{\"offset\":297,\"length\":5}},{\"content\":\"258001605\",\"polygon\":[4.4056,1.5869,5.308,1.5869,5.3029,1.7745,4.4005,1.7694],\"confidence\":0.95,\"span\":{\"offset\":303,\"length\":9}},{\"content\":\"מקור\",\"polygon\":[3.2193,1.7187,3.5741,1.7187,3.5741,1.8961,3.2193,1.8961],\"confidence\":0.98,\"span\":{\"offset\":313,\"length\":4}},{\"content\":\"מסמך\",\"polygon\":[1.6527,1.7187,2.0735,1.7187,2.0735,1.9012,1.6476,1.8961],\"confidence\":0.982,\"span\":{\"offset\":318,\"length\":4}},{\"content\":\"ממוחשב\",\"polygon\":[0.9683,1.7136,1.6071,1.7187,1.6071,1.8961,0.9632,1.8961],\"confidence\":0.975,\"span\":{\"offset\":323,\"length\":6}},{\"content\":\"לכבוד:\",\"polygon\":[9.4854,1.957,9.9112,1.9418,9.9112,2.0989,9.4905,2.0989],\"confidence\":0.961,\"span\":{\"offset\":330,\"length\":6}},{\"content\":\"יעד\",\"polygon\":[6.9455,1.9316,7.1685,1.9316,7.1685,2.104,6.9455,2.104],\"confidence\":0.982,\"span\":{\"offset\":337,\"length\":3}},{\"content\":\"למשלוח:\",\"polygon\":[6.3574,1.9316,6.91,1.9316,6.91,2.104,6.3523,2.104],\"confidence\":0.951,\"span\":{\"offset\":341,\"length\":7}},{\"content\":\"תאריך:\",\"polygon\":[3.6654,1.9367,4.1369,1.9468,4.1369,2.1141,3.6654,2.104],\"confidence\":0.964,\"span\":{\"offset\":349,\"length\":6}},{\"content\":\"26/10/2025\",\"polygon\":[2.8441,1.9367,3.6248,1.9367,3.6248,2.104,2.8441,2.0989],\"confidence\":0.897,\"span\":{\"offset\":356,\"length\":10}},{\"content\":\"ט.פ.י\",\"polygon\":[9.5259,2.1344,9.9214,2.1395,9.9214,2.322,9.5259,2.322],\"confidence\":0.976,\"span\":{\"offset\":367,\"length\":5}},{\"content\":\"פל-ים\",\"polygon\":[9.1153,2.1293,9.4854,2.1344,9.4854,2.322,9.1153,2.3271],\"confidence\":0.961,\"span\":{\"offset\":373,\"length\":5}},{\"content\":\"בע״מ\",\"polygon\":[8.6692,2.1243,9.0747,2.1293,9.0798,2.3271,8.6692,2.3372],\"confidence\":0.92,\"span\":{\"offset\":379,\"length\":4}},{\"content\":\"ט.פ.י\",\"polygon\":[6.8491,2.1344,7.1685,2.1344,7.1685,2.2967,6.8491,2.2916],\"confidence\":0.98,\"span\":{\"offset\":384,\"length\":5}},{\"content\":\"פל-ים\",\"polygon\":[6.5145,2.1344,6.8137,2.1344,6.8187,2.2916,6.5196,2.2967],\"confidence\":0.981,\"span\":{\"offset\":390,\"length\":5}},{\"content\":\"בע״מ\",\"polygon\":[6.1597,2.1293,6.4841,2.1344,6.4841,2.2967,6.1647,2.3017],\"confidence\":0.75,\"span\":{\"offset\":396,\"length\":4}},{\"content\":\"מס׳\",\"polygon\":[3.8834,2.1293,4.1369,2.1293,4.1369,2.3017,3.8834,2.3017],\"confidence\":0.84,\"span\":{\"offset\":401,\"length\":3}},{\"content\":\"לקוח:\",\"polygon\":[3.5336,2.1293,3.8479,2.1293,3.8479,2.3017,3.5336,2.3017],\"confidence\":0.961,\"span\":{\"offset\":405,\"length\":5}},{\"content\":\"1340\",\"polygon\":[3.1736,2.1293,3.4981,2.1293,3.4981,2.3017,3.1736,2.3068],\"confidence\":0.98,\"span\":{\"offset\":411,\"length\":4}},{\"content\":\"ע.מ.\",\"polygon\":[2.7021,2.1293,2.9911,2.1293,2.9911,2.3068,2.6971,2.3068],\"confidence\":0.982,\"span\":{\"offset\":416,\"length\":4}},{\"content\":\"לקוח:\",\"polygon\":[2.3523,2.1293,2.6667,2.1293,2.6616,2.3068,2.3473,2.3068],\"confidence\":0.963,\"span\":{\"offset\":421,\"length\":5}},{\"content\":\"513327064\",\"polygon\":[1.5868,2.1243,2.3168,2.1293,2.3118,2.3068,1.5817,2.3068],\"confidence\":0.92,\"span\":{\"offset\":427,\"length\":9}},{\"content\":\"הקטיף\",\"polygon\":[9.5209,2.3524,9.9112,2.3575,9.9062,2.5299,9.5209,2.5299],\"confidence\":0.976,\"span\":{\"offset\":437,\"length\":5}},{\"content\":\"11\",\"polygon\":[9.3029,2.3524,9.4752,2.3524,9.4752,2.5299,9.3029,2.5299],\"confidence\":0.982,\"span\":{\"offset\":443,\"length\":2}},{\"content\":\"הקטיף\",\"polygon\":[6.7984,2.3321,7.1736,2.3271,7.1787,2.5045,6.8035,2.4944],\"confidence\":0.982,\"span\":{\"offset\":446,\"length\":5}},{\"content\":\"11\",\"polygon\":[6.5906,2.3271,6.7579,2.3321,6.763,2.4944,6.5957,2.4893],\"confidence\":0.982,\"span\":{\"offset\":452,\"length\":2}},{\"content\":\"מס׳\",\"polygon\":[3.8935,2.322,4.1419,2.322,4.147,2.4893,3.8986,2.4944],\"confidence\":0.807,\"span\":{\"offset\":455,\"length\":3}},{\"content\":\"הזמנת\",\"polygon\":[3.5589,2.322,3.8631,2.322,3.8631,2.4944,3.5589,2.4994],\"confidence\":0.982,\"span\":{\"offset\":459,\"length\":5}},{\"content\":\"לקוח:\",\"polygon\":[3.1533,2.322,3.5234,2.322,3.5285,2.4994,3.1584,2.4994],\"confidence\":0.976,\"span\":{\"offset\":465,\"length\":5}},{\"content\":\"2501005923\",\"polygon\":[2.3118,2.3271,3.1179,2.322,3.1229,2.4994,2.3118,2.4893],\"confidence\":0.892,\"span\":{\"offset\":471,\"length\":10}},{\"content\":\"פארק\",\"polygon\":[9.5817,2.5501,9.9163,2.5552,9.9163,2.7225,9.5817,2.7276],\"confidence\":0.982,\"span\":{\"offset\":482,\"length\":4}},{\"content\":\"תעשיות\",\"polygon\":[9.0747,2.5451,9.5462,2.5501,9.5462,2.7276,9.0798,2.7276],\"confidence\":0.981,\"span\":{\"offset\":487,\"length\":6}},{\"content\":\"עמק\",\"polygon\":[8.7655,2.54,9.0291,2.5451,9.0342,2.7276,8.7655,2.7276],\"confidence\":0.982,\"span\":{\"offset\":494,\"length\":3}},{\"content\":\"חפר\",\"polygon\":[8.4867,2.5349,8.7249,2.54,8.73,2.7276,8.4867,2.7276],\"confidence\":0.961,\"span\":{\"offset\":498,\"length\":3}},{\"content\":\"3877701\",\"polygon\":[7.8479,2.5299,8.4512,2.5349,8.4512,2.7276,7.8529,2.7175],\"confidence\":0.966,\"span\":{\"offset\":502,\"length\":7}},{\"content\":\"פארק\",\"polygon\":[6.8339,2.5197,7.1635,2.5299,7.1635,2.687,6.8339,2.6921],\"confidence\":0.982,\"span\":{\"offset\":510,\"length\":4}},{\"content\":\"תעשיות\",\"polygon\":[6.3726,2.5147,6.7984,2.5197,6.7984,2.6921,6.3777,2.6921],\"confidence\":0.961,\"span\":{\"offset\":515,\"length\":6}},{\"content\":\"עמק\",\"polygon\":[6.0786,2.5096,6.327,2.5147,6.332,2.6921,6.0836,2.6921],\"confidence\":0.982,\"span\":{\"offset\":522,\"length\":3}},{\"content\":\"חפר\",\"polygon\":[5.82,2.5045,6.0431,2.5096,6.0481,2.6921,5.8251,2.6921],\"confidence\":0.98,\"span\":{\"offset\":526,\"length\":3}},{\"content\":\"3877701\",\"polygon\":[5.1812,2.5045,5.7744,2.5045,5.7794,2.6921,5.1863,2.6921],\"confidence\":0.963,\"span\":{\"offset\":530,\"length\":7}},{\"content\":\"מס׳\",\"polygon\":[3.8834,2.5096,4.1369,2.5096,4.1369,2.682,3.8834,2.682],\"confidence\":0.88,\"span\":{\"offset\":538,\"length\":3}},{\"content\":\"הזמנת\",\"polygon\":[3.5538,2.5096,3.8479,2.5096,3.853,2.682,3.5538,2.682],\"confidence\":0.982,\"span\":{\"offset\":542,\"length\":5}},{\"content\":\"פלסאון:\",\"polygon\":[3.0367,2.5147,3.5184,2.5147,3.5234,2.682,3.0367,2.682],\"confidence\":0.976,\"span\":{\"offset\":548,\"length\":7}},{\"content\":\"60000013\",\"polygon\":[2.3523,2.5147,3.0013,2.5147,3.0063,2.682,2.3574,2.6769],\"confidence\":0.961,\"span\":{\"offset\":556,\"length\":8}},{\"content\":\"מס׳\",\"polygon\":[3.8884,2.7022,4.1318,2.7022,4.1318,2.8695,3.8884,2.8695],\"confidence\":0.84,\"span\":{\"offset\":565,\"length\":3}},{\"content\":\"תעודת\",\"polygon\":[3.5437,2.7022,3.853,2.7022,3.853,2.8695,3.5437,2.8695],\"confidence\":0.981,\"span\":{\"offset\":569,\"length\":5}},{\"content\":\"משלוח:\",\"polygon\":[3.0367,2.7022,3.5082,2.7022,3.5082,2.8695,3.0367,2.8695],\"confidence\":0.956,\"span\":{\"offset\":575,\"length\":6}},{\"content\":\"108379736,\",\"polygon\":[2.18,2.7022,3.0013,2.7022,3.0013,2.8746,2.18,2.8797],\"confidence\":0.952,\"span\":{\"offset\":582,\"length\":10}},{\"content\":\"108379734,\",\"polygon\":[1.3992,2.6972,2.1495,2.7022,2.1495,2.8797,1.3992,2.8848],\"confidence\":0.932,\"span\":{\"offset\":593,\"length\":10}},{\"content\":\"108367753\",\"polygon\":[2.5501,2.8949,3.2547,2.9,3.2547,3.0673,2.5551,3.0622],\"confidence\":0.961,\"span\":{\"offset\":604,\"length\":9}},{\"content\":\",108367755\",\"polygon\":[3.2852,2.9,4.1217,2.8898,4.1217,3.0673,3.2852,3.0673],\"confidence\":0.953,\"span\":{\"offset\":614,\"length\":10}},{\"content\":\"מס׳\",\"polygon\":[3.8884,3.0926,4.1318,3.0926,4.1369,3.265,3.8935,3.265],\"confidence\":0.827,\"span\":{\"offset\":625,\"length\":3}},{\"content\":\"הקצאה:\",\"polygon\":[3.417,3.0876,3.858,3.0926,3.858,3.265,3.422,3.2599],\"confidence\":0.935,\"span\":{\"offset\":629,\"length\":6}},{\"content\":\"301086521\",\"polygon\":[2.6464,3.0876,3.3866,3.0876,3.3866,3.2599,2.6514,3.2549],\"confidence\":0.892,\"span\":{\"offset\":636,\"length\":9}},{\"content\":\"20251028104848545\",\"polygon\":[1.1964,3.0876,2.616,3.0876,2.616,3.2549,1.2015,3.2498],\"confidence\":0.83,\"span\":{\"offset\":646,\"length\":17}},{\"content\":\"הערות:\",\"polygon\":[9.46,3.3867,9.9112,3.3917,9.9112,3.5134,9.4651,3.5185],\"confidence\":0.975,\"span\":{\"offset\":664,\"length\":6}},{\"content\":\"מס׳\",\"polygon\":[9.6375,3.6959,9.8048,3.6959,9.8048,3.7973,9.6375,3.7923],\"confidence\":0.888,\"span\":{\"offset\":671,\"length\":3}},{\"content\":\"מק״ט\",\"polygon\":[8.948,3.6959,9.2116,3.6909,9.2116,3.8176,8.9531,3.8176],\"confidence\":0.961,\"span\":{\"offset\":675,\"length\":4}},{\"content\":\"לקוח\",\"polygon\":[8.6945,3.6959,8.9176,3.6959,8.9226,3.8176,8.7047,3.8227],\"confidence\":0.978,\"span\":{\"offset\":680,\"length\":4}},{\"content\":\"מק״ט\",\"polygon\":[7.7972,3.6959,8.0557,3.6959,8.0557,3.8125,7.8022,3.8125],\"confidence\":0.908,\"span\":{\"offset\":685,\"length\":4}},{\"content\":\"פלסאון\",\"polygon\":[7.4322,3.701,7.7718,3.6959,7.7718,3.8125,7.4372,3.8227],\"confidence\":0.965,\"span\":{\"offset\":690,\"length\":6}},{\"content\":\"תיאור\",\"polygon\":[5.8099,3.7111,6.0684,3.7111,6.0633,3.8024,5.8099,3.8024],\"confidence\":0.982,\"span\":{\"offset\":697,\"length\":5}},{\"content\":\"יח׳\",\"polygon\":[4.4461,3.6959,4.5982,3.6959,4.5982,3.7923,4.4461,3.7872],\"confidence\":0.847,\"span\":{\"offset\":703,\"length\":3}},{\"content\":\"כמות\",\"polygon\":[3.8834,3.7111,4.0811,3.7061,4.0862,3.7973,3.8834,3.8024],\"confidence\":0.982,\"span\":{\"offset\":707,\"length\":4}},{\"content\":\"מחיר\",\"polygon\":[3.2395,3.7111,3.4423,3.7162,3.4372,3.7973,3.2395,3.7923],\"confidence\":0.982,\"span\":{\"offset\":712,\"length\":4}},{\"content\":\"סכום\",\"polygon\":[2.5146,3.7162,2.7123,3.7162,2.7123,3.8024,2.5146,3.7973],\"confidence\":0.982,\"span\":{\"offset\":717,\"length\":4}},{\"content\":\"אחוז\",\"polygon\":[1.7997,3.7061,2.0127,3.7061,2.0127,3.8024,1.7997,3.8024],\"confidence\":0.982,\"span\":{\"offset\":722,\"length\":4}},{\"content\":\"סכום\",\"polygon\":[1.0646,3.7111,1.2522,3.7111,1.2522,3.7973,1.0646,3.7973],\"confidence\":0.982,\"span\":{\"offset\":727,\"length\":4}},{\"content\":\"מידה\",\"polygon\":[4.4258,3.848,4.6388,3.848,4.6388,3.9393,4.4258,3.9393],\"confidence\":0.982,\"span\":{\"offset\":732,\"length\":4}},{\"content\":\"יח׳\",\"polygon\":[3.2649,3.8379,3.417,3.8379,3.417,3.9342,3.2649,3.9292],\"confidence\":0.844,\"span\":{\"offset\":737,\"length\":3}},{\"content\":\"ברוטו\",\"polygon\":[2.4639,3.8379,2.7376,3.848,2.7326,3.9494,2.4639,3.9393],\"confidence\":0.942,\"span\":{\"offset\":741,\"length\":5}},{\"content\":\"הנחה\",\"polygon\":[1.8149,3.848,2.0329,3.848,2.0329,3.9393,1.8149,3.9393],\"confidence\":0.982,\"span\":{\"offset\":747,\"length\":4}},{\"content\":\"נטו\",\"polygon\":[1.0748,3.848,1.2269,3.8531,1.2269,3.9444,1.0748,3.9393],\"confidence\":0.882,\"span\":{\"offset\":752,\"length\":3}},{\"content\":\"ב-\",\"polygon\":[3.4068,3.9798,3.5234,3.9849,3.5234,4.0914,3.4068,4.0863],\"confidence\":0.982,\"span\":{\"offset\":756,\"length\":2}},{\"content\":\"ש״ח\",\"polygon\":[3.1838,3.9748,3.3866,3.9798,3.3866,4.0863,3.1838,4.0812],\"confidence\":0.978,\"span\":{\"offset\":759,\"length\":3}},{\"content\":\"ב-ש״ח\",\"polygon\":[2.4487,3.9798,2.763,3.9798,2.768,4.0863,2.4487,4.0812],\"confidence\":0.964,\"span\":{\"offset\":763,\"length\":5}},{\"content\":\"ב-ש״ח\",\"polygon\":[0.9987,3.9798,1.3181,3.9849,1.313,4.0863,0.9987,4.0863],\"confidence\":0.966,\"span\":{\"offset\":769,\"length\":5}},{\"content\":\"1\",\"polygon\":[9.8453,4.2536,9.9062,4.2536,9.9062,4.3601,9.8453,4.3601],\"confidence\":0.982,\"span\":{\"offset\":775,\"length\":1}},{\"content\":\"33008600\",\"polygon\":[7.858,4.2587,8.3701,4.2536,8.3701,4.3702,7.8631,4.3652],\"confidence\":0.977,\"span\":{\"offset\":777,\"length\":8}},{\"content\":\"מיכל\",\"polygon\":[6.7832,4.2536,6.9962,4.2536,6.9962,4.3753,6.7832,4.3753],\"confidence\":0.982,\"span\":{\"offset\":786,\"length\":4}},{\"content\":\"דואון\",\"polygon\":[6.5196,4.2536,6.7579,4.2536,6.7579,4.3753,6.5196,4.3804],\"confidence\":0.982,\"span\":{\"offset\":791,\"length\":5}},{\"content\":\"לבן\",\"polygon\":[6.3371,4.2536,6.4943,4.2536,6.4943,4.3804,6.3371,4.3804],\"confidence\":0.982,\"span\":{\"offset\":797,\"length\":3}},{\"content\":\"מורכב\",\"polygon\":[6.0684,4.2536,6.3168,4.2536,6.3168,4.3804,6.0684,4.3804],\"confidence\":0.982,\"span\":{\"offset\":801,\"length\":5}},{\"content\":\"יחי\",\"polygon\":[4.5881,4.2638,4.7047,4.2638,4.7047,4.3652,4.5881,4.3652],\"confidence\":0.708,\"span\":{\"offset\":807,\"length\":3}},{\"content\":\"120\",\"polygon\":[3.9949,4.2536,4.1673,4.2536,4.1673,4.3601,3.9949,4.3601],\"confidence\":0.997,\"span\":{\"offset\":811,\"length\":3}},{\"content\":\"105.00\",\"polygon\":[3.2852,4.2587,3.6299,4.2536,3.6299,4.3702,3.2902,4.3652],\"confidence\":0.982,\"span\":{\"offset\":815,\"length\":6}},{\"content\":\"12,600.00\",\"polygon\":[2.398,4.2536,2.8948,4.2536,2.8948,4.3753,2.403,4.3702],\"confidence\":0.961,\"span\":{\"offset\":822,\"length\":9}},{\"content\":\"0.00\",\"polygon\":[1.9366,4.2536,2.1698,4.2536,2.1698,4.3652,1.9366,4.3652],\"confidence\":0.982,\"span\":{\"offset\":832,\"length\":4}},{\"content\":\"12,600.00\",\"polygon\":[1.0241,4.2536,1.5209,4.2536,1.5209,4.3753,1.0291,4.3702],\"confidence\":0.976,\"span\":{\"offset\":837,\"length\":9}},{\"content\":\"2\",\"polygon\":[9.8504,4.4057,9.9062,4.4057,9.9011,4.5071,9.8453,4.502],\"confidence\":0.964,\"span\":{\"offset\":847,\"length\":1}},{\"content\":\"33007400\",\"polygon\":[7.858,4.4006,8.3701,4.4006,8.3701,4.5173,7.858,4.5173],\"confidence\":0.975,\"span\":{\"offset\":849,\"length\":8}},{\"content\":\"מיכל\",\"polygon\":[6.7832,4.4057,6.9911,4.4057,6.986,4.5223,6.7832,4.5223],\"confidence\":0.982,\"span\":{\"offset\":858,\"length\":4}},{\"content\":\"קלסאון\",\"polygon\":[6.4385,4.4006,6.763,4.4057,6.7579,4.5223,6.4385,4.5274],\"confidence\":0.982,\"span\":{\"offset\":863,\"length\":6}},{\"content\":\"לבן\",\"polygon\":[6.256,4.4057,6.4132,4.4006,6.4132,4.5274,6.256,4.5274],\"confidence\":0.982,\"span\":{\"offset\":870,\"length\":3}},{\"content\":\"מורכב\",\"polygon\":[5.9822,4.4057,6.2306,4.4057,6.2306,4.5274,5.9822,4.5274],\"confidence\":0.982,\"span\":{\"offset\":874,\"length\":5}},{\"content\":\"יחי\",\"polygon\":[4.5881,4.4108,4.7047,4.4108,4.6996,4.5071,4.5881,4.502],\"confidence\":0.719,\"span\":{\"offset\":880,\"length\":3}},{\"content\":\"448\",\"polygon\":[3.9797,4.4006,4.1774,4.4006,4.1774,4.5122,3.9797,4.5071],\"confidence\":0.982,\"span\":{\"offset\":884,\"length\":3}},{\"content\":\"105.00\",\"polygon\":[3.2852,4.4006,3.6248,4.4006,3.6299,4.5173,3.2852,4.5122],\"confidence\":0.982,\"span\":{\"offset\":888,\"length\":6}},{\"content\":\"47,040.00\",\"polygon\":[2.3929,4.4006,2.8948,4.4006,2.8999,4.5223,2.3929,4.5223],\"confidence\":0.976,\"span\":{\"offset\":895,\"length\":9}},{\"content\":\"0.00\",\"polygon\":[1.9417,4.3956,2.1648,4.3956,2.1648,4.5122,1.9417,4.5122],\"confidence\":0.982,\"span\":{\"offset\":905,\"length\":4}},{\"content\":\"47,040.00\",\"polygon\":[1.019,4.4006,1.5209,4.4006,1.5209,4.5173,1.019,4.5223],\"confidence\":0.979,\"span\":{\"offset\":910,\"length\":9}},{\"content\":\"3\",\"polygon\":[9.8352,4.5578,9.9011,4.5578,9.9011,4.6643,9.8352,4.6643],\"confidence\":0.982,\"span\":{\"offset\":920,\"length\":1}},{\"content\":\"33008600\",\"polygon\":[7.8529,4.5527,8.365,4.5527,8.365,4.6694,7.858,4.6694],\"confidence\":0.976,\"span\":{\"offset\":922,\"length\":8}},{\"content\":\"מיכל\",\"polygon\":[6.7782,4.5578,6.9911,4.5578,6.9962,4.6694,6.7832,4.6744],\"confidence\":0.982,\"span\":{\"offset\":931,\"length\":4}},{\"content\":\"דואון\",\"polygon\":[6.5196,4.5578,6.7579,4.5578,6.7579,4.6744,6.5196,4.6795],\"confidence\":0.982,\"span\":{\"offset\":936,\"length\":5}},{\"content\":\"לבן\",\"polygon\":[6.3371,4.5578,6.4943,4.5578,6.4943,4.6795,6.3371,4.6795],\"confidence\":0.982,\"span\":{\"offset\":942,\"length\":3}},{\"content\":\"מורכב\",\"polygon\":[6.0735,4.5578,6.3168,4.5578,6.3168,4.6795,6.0684,4.6795],\"confidence\":0.982,\"span\":{\"offset\":946,\"length\":5}},{\"content\":\"יחי\",\"polygon\":[4.5881,4.5629,4.7047,4.5629,4.6996,4.6643,4.5881,4.6592],\"confidence\":0.692,\"span\":{\"offset\":952,\"length\":3}},{\"content\":\"600\",\"polygon\":[3.9949,4.5578,4.1876,4.5578,4.1825,4.6643,3.9949,4.6643],\"confidence\":0.982,\"span\":{\"offset\":956,\"length\":3}},{\"content\":\"105.00\",\"polygon\":[3.2852,4.5527,3.6299,4.5527,3.6299,4.6694,3.2902,4.6643],\"confidence\":0.982,\"span\":{\"offset\":960,\"length\":6}},{\"content\":\"63,000.00\",\"polygon\":[2.3828,4.5578,2.8897,4.5477,2.8897,4.6744,2.3929,4.6744],\"confidence\":0.966,\"span\":{\"offset\":967,\"length\":9}},{\"content\":\"0.00\",\"polygon\":[1.9417,4.5527,2.1648,4.5527,2.1648,4.6643,1.9417,4.6643],\"confidence\":0.982,\"span\":{\"offset\":977,\"length\":4}},{\"content\":\"63,000.00\",\"polygon\":[1.019,4.5527,1.5209,4.5527,1.5209,4.6694,1.0241,4.6744],\"confidence\":0.976,\"span\":{\"offset\":982,\"length\":9}},{\"content\":\"4\",\"polygon\":[9.8504,4.7048,9.9062,4.7048,9.9062,4.8012,9.8504,4.8012],\"confidence\":0.982,\"span\":{\"offset\":992,\"length\":1}},{\"content\":\"33008600\",\"polygon\":[7.8479,4.7048,8.3701,4.7099,8.3701,4.8265,7.8529,4.8214],\"confidence\":0.979,\"span\":{\"offset\":994,\"length\":8}},{\"content\":\"מיכל\",\"polygon\":[6.7782,4.7048,6.9911,4.7048,6.9911,4.8265,6.7782,4.8265],\"confidence\":0.982,\"span\":{\"offset\":1003,\"length\":4}},{\"content\":\"דואון\",\"polygon\":[6.5145,4.7048,6.7528,4.7048,6.7528,4.8265,6.5145,4.8265],\"confidence\":0.982,\"span\":{\"offset\":1008,\"length\":5}},{\"content\":\"לבן\",\"polygon\":[6.3422,4.7048,6.4892,4.7048,6.4892,4.8316,6.3371,4.8316],\"confidence\":0.982,\"span\":{\"offset\":1014,\"length\":3}},{\"content\":\"מורכב\",\"polygon\":[6.0684,4.7048,6.3168,4.7048,6.3118,4.8316,6.0684,4.8367],\"confidence\":0.982,\"span\":{\"offset\":1018,\"length\":5}},{\"content\":\"יחי\",\"polygon\":[4.5881,4.72,4.7047,4.72,4.7047,4.8113,4.5881,4.8113],\"confidence\":0.488,\"span\":{\"offset\":1024,\"length\":3}},{\"content\":\"40\",\"polygon\":[4.0456,4.7048,4.1825,4.7048,4.1825,4.8113,4.0456,4.8113],\"confidence\":0.982,\"span\":{\"offset\":1028,\"length\":2}},{\"content\":\"105.00\",\"polygon\":[3.2852,4.7048,3.6248,4.7048,3.6248,4.8214,3.2852,4.8214],\"confidence\":0.982,\"span\":{\"offset\":1031,\"length\":6}},{\"content\":\"4,200.00\",\"polygon\":[2.4436,4.7048,2.8999,4.6998,2.8999,4.8265,2.4487,4.8265],\"confidence\":0.98,\"span\":{\"offset\":1038,\"length\":8}},{\"content\":\"0.00\",\"polygon\":[1.9468,4.7048,2.1597,4.7048,2.1597,4.8164,1.9468,4.8164],\"confidence\":0.982,\"span\":{\"offset\":1047,\"length\":4}},{\"content\":\"4,200.00\",\"polygon\":[1.0748,4.6744,1.4956,4.6744,1.5006,4.8417,1.0748,4.8468],\"confidence\":0.938,\"span\":{\"offset\":1052,\"length\":8}},{\"content\":\"לפירעון\",\"polygon\":[9.4905,5.3082,9.9112,5.3082,9.9112,5.4603,9.4905,5.4603],\"confidence\":0.966,\"span\":{\"offset\":1061,\"length\":7}},{\"content\":\"עד:\",\"polygon\":[9.2725,5.3082,9.46,5.3082,9.46,5.4603,9.2725,5.4603],\"confidence\":0.981,\"span\":{\"offset\":1069,\"length\":3}},{\"content\":\"28/02/2026\",\"polygon\":[8.6286,5.3082,9.242,5.3082,9.242,5.4603,8.6337,5.4552],\"confidence\":0.943,\"span\":{\"offset\":1073,\"length\":10}},{\"content\":\"סה״כ\",\"polygon\":[2.839,5.3234,3.1432,5.3234,3.1331,5.4704,2.8289,5.4603],\"confidence\":0.892,\"span\":{\"offset\":1084,\"length\":4}},{\"content\":\"ברוטו\",\"polygon\":[2.5044,5.3284,2.8086,5.3234,2.8035,5.4603,2.5044,5.4603],\"confidence\":0.982,\"span\":{\"offset\":1089,\"length\":5}},{\"content\":\"בש״ח:\",\"polygon\":[2.1343,5.3234,2.4791,5.3284,2.474,5.4603,2.1343,5.4704],\"confidence\":0.937,\"span\":{\"offset\":1095,\"length\":5}},{\"content\":\"126,840.00\",\"polygon\":[1.0849,5.3284,1.6527,5.3234,1.6527,5.4603,1.09,5.4552],\"confidence\":0.961,\"span\":{\"offset\":1101,\"length\":10}},{\"content\":\"תנאי\",\"polygon\":[9.6527,5.4755,9.9214,5.4755,9.9214,5.6276,9.6527,5.6276],\"confidence\":0.982,\"span\":{\"offset\":1112,\"length\":4}},{\"content\":\"תשלום:\",\"polygon\":[9.2268,5.4755,9.6223,5.4755,9.6223,5.6276,9.2268,5.6225],\"confidence\":0.965,\"span\":{\"offset\":1117,\"length\":6}},{\"content\":\"שוטף\",\"polygon\":[8.9581,5.4755,9.1964,5.4755,9.1964,5.6225,8.9632,5.6225],\"confidence\":0.982,\"span\":{\"offset\":1124,\"length\":4}},{\"content\":\"+\",\"polygon\":[8.8314,5.4755,8.9277,5.4755,8.9328,5.6225,8.8314,5.6225],\"confidence\":0.975,\"span\":{\"offset\":1129,\"length\":1}},{\"content\":\"120\",\"polygon\":[8.6235,5.4755,8.801,5.4755,8.801,5.6225,8.6235,5.6225],\"confidence\":0.982,\"span\":{\"offset\":1131,\"length\":3}},{\"content\":\"הקמת\",\"polygon\":[9.6273,5.6326,9.9214,5.6326,9.9163,5.7949,9.6223,5.7898],\"confidence\":0.982,\"span\":{\"offset\":1135,\"length\":4}},{\"content\":\"הזמנה:\",\"polygon\":[9.2065,5.6326,9.5918,5.6326,9.5918,5.7898,9.2065,5.7898],\"confidence\":0.98,\"span\":{\"offset\":1140,\"length\":6}},{\"content\":\"Moshe,\",\"polygon\":[8.4207,5.6326,8.8314,5.6326,8.8263,5.7847,8.4207,5.7847],\"confidence\":0.975,\"span\":{\"offset\":1147,\"length\":6}},{\"content\":\"Megi\",\"polygon\":[8.8618,5.6326,9.1761,5.6326,9.1711,5.7898,8.8567,5.7898],\"confidence\":0.961,\"span\":{\"offset\":1154,\"length\":4}},{\"content\":\"סה״כ\",\"polygon\":[2.839,5.516,3.1229,5.5109,3.128,5.6478,2.839,5.6478],\"confidence\":0.961,\"span\":{\"offset\":1159,\"length\":4}},{\"content\":\"נטו:\",\"polygon\":[2.5957,5.516,2.8086,5.516,2.8137,5.6428,2.5957,5.6428],\"confidence\":0.97,\"span\":{\"offset\":1164,\"length\":4}},{\"content\":\"126,840.00\",\"polygon\":[1.09,5.516,1.6527,5.5059,1.6527,5.6428,1.0951,5.6326],\"confidence\":0.97,\"span\":{\"offset\":1169,\"length\":10}},{\"content\":\"הפקת\",\"polygon\":[9.6324,5.7949,9.9112,5.7999,9.9062,5.947,9.6324,5.947],\"confidence\":0.982,\"span\":{\"offset\":1180,\"length\":4}},{\"content\":\"חשבונית:\",\"polygon\":[9.095,5.7949,9.602,5.7949,9.602,5.952,9.095,5.947],\"confidence\":0.961,\"span\":{\"offset\":1185,\"length\":8}},{\"content\":\"Sharett,\",\"polygon\":[8.3548,5.7949,8.7858,5.7949,8.7858,5.947,8.3599,5.9419],\"confidence\":0.92,\"span\":{\"offset\":1194,\"length\":8}},{\"content\":\"Yael\",\"polygon\":[8.8162,5.7949,9.0646,5.7949,9.0646,5.947,8.8162,5.947],\"confidence\":0.947,\"span\":{\"offset\":1203,\"length\":4}},{\"content\":\"מע״מ\",\"polygon\":[2.8289,5.6985,3.1331,5.6935,3.1331,5.8405,2.8289,5.8354],\"confidence\":0.942,\"span\":{\"offset\":1208,\"length\":4}},{\"content\":\"18%:\",\"polygon\":[2.4132,5.7036,2.7376,5.6985,2.7376,5.8354,2.4132,5.8405],\"confidence\":0.98,\"span\":{\"offset\":1213,\"length\":4}},{\"content\":\"22,831.20\",\"polygon\":[1.1356,5.6935,1.6527,5.6935,1.6527,5.8253,1.1407,5.8202],\"confidence\":0.966,\"span\":{\"offset\":1218,\"length\":9}},{\"content\":\"פלסאון\",\"polygon\":[9.5259,5.947,9.9062,5.947,9.9062,6.1041,9.531,6.1041],\"confidence\":0.982,\"span\":{\"offset\":1228,\"length\":6}},{\"content\":\"בע״מ\",\"polygon\":[9.2319,5.952,9.4955,5.947,9.5006,6.1041,9.237,6.1041],\"confidence\":0.94,\"span\":{\"offset\":1235,\"length\":4}},{\"content\":\"סה״כ\",\"polygon\":[2.834,5.8709,3.1381,5.8658,3.1381,6.0179,2.834,6.0129],\"confidence\":0.951,\"span\":{\"offset\":1240,\"length\":4}},{\"content\":\"לתשלום\",\"polygon\":[2.4132,5.8709,2.8035,5.8709,2.8035,6.0129,2.4132,6.0179],\"confidence\":0.977,\"span\":{\"offset\":1245,\"length\":6}},{\"content\":\"בש״ח:\",\"polygon\":[2.0279,5.8658,2.3828,5.8709,2.3828,6.0179,2.0329,6.0281],\"confidence\":0.933,\"span\":{\"offset\":1252,\"length\":5}},{\"content\":\"149,671.20\",\"polygon\":[1.09,5.876,1.6578,5.8709,1.6527,6.0027,1.0951,5.9977],\"confidence\":0.961,\"span\":{\"offset\":1258,\"length\":10}}],\"lines\":[{\"content\":\"מסמך ממוחשב\",\"polygon\":[0.1115,0.1521,0.5779,0.1521,0.5779,0.2332,0.1115,0.2332],\"spans\":[{\"offset\":0,\"length\":11}]},{\"content\":\"חתום דיגיטלית ומאושר\",\"polygon\":[0.1115,0.2383,0.5779,0.2434,0.5779,0.2991,0.1115,0.2941],\"spans\":[{\"offset\":12,\"length\":20}]},{\"content\":\"על ידי גורם מאשר\",\"polygon\":[0.1572,0.2991,0.5222,0.2991,0.5222,0.3549,0.1572,0.3498],\"spans\":[{\"offset\":33,\"length\":16}]},{\"content\":\"personal\",\"polygon\":[0.076,0.3752,0.6084,0.3549,0.6134,0.4968,0.076,0.5019],\"spans\":[{\"offset\":50,\"length\":8}]},{\"content\":\"פלסאון בע״מ | מס׳ עוסק מורשה 512865254 | פטור מניכוי מס הכנסה במקור לפי אישור פקיד שומה חיפה\",\"polygon\":[5.5969,0.5678,9.9163,0.5628,9.9163,0.6895,5.5969,0.6946],\"spans\":[{\"offset\":59,\"length\":92}]},{\"content\":\"מעגן מיכאל, ד.נ. מנשה 3780500 | טלפון: 04-6394721, פקס: 04-6394816 | www.plasson.co.il | Yaels@plasson.co.il\",\"polygon\":[5.313,0.7098,9.9214,0.7098,9.9214,0.8315,5.313,0.8365],\"spans\":[{\"offset\":152,\"length\":108}]},{\"content\":\"-\",\"polygon\":[3.3308,0.6388,3.5538,0.6337,3.5589,0.9379,3.3359,0.943],\"spans\":[{\"offset\":261,\"length\":1}]},{\"content\":\"PLASSON®\",\"polygon\":[1.1508,0.5628,2.1495,0.5628,2.1495,0.7351,1.1559,0.7503],\"spans\":[{\"offset\":263,\"length\":8}]},{\"content\":\"עמוד 1 מתוך 1\",\"polygon\":[1.09,1.3435,1.9569,1.3435,1.9569,1.521,1.09,1.5159],\"spans\":[{\"offset\":272,\"length\":13}]},{\"content\":\"חשבונית מס מספר: 258001605\",\"polygon\":[4.4005,1.5818,6.7427,1.5919,6.7427,1.7795,4.4005,1.7643],\"spans\":[{\"offset\":286,\"length\":26}]},{\"content\":\"מקור\",\"polygon\":[3.1838,1.7187,3.5741,1.7288,3.5741,1.8911,3.1838,1.8961],\"spans\":[{\"offset\":313,\"length\":4}]},{\"content\":\"מסמך ממוחשב\",\"polygon\":[0.9278,1.7085,2.0684,1.7136,2.0684,1.8961,0.9278,1.8911],\"spans\":[{\"offset\":318,\"length\":11}]},{\"content\":\"לכבוד:\",\"polygon\":[9.4803,1.9468,9.9163,1.9418,9.9163,2.0939,9.4854,2.0989],\"spans\":[{\"offset\":330,\"length\":6}]},{\"content\":\"יעד למשלוח:\",\"polygon\":[6.3523,1.9316,7.1635,1.9316,7.1635,2.0989,6.3523,2.104],\"spans\":[{\"offset\":337,\"length\":11}]},{\"content\":\"תאריך: 26/10/2025\",\"polygon\":[2.8441,1.9316,4.1369,1.9418,4.1369,2.1091,2.8441,2.0939],\"spans\":[{\"offset\":349,\"length\":17}]},{\"content\":\"ט.פ.י פל-ים בע״מ\",\"polygon\":[8.6387,2.1192,9.9214,2.1243,9.9214,2.3321,8.6387,2.3321],\"spans\":[{\"offset\":367,\"length\":16}]},{\"content\":\"ט.פ.י פל-ים בע״מ\",\"polygon\":[6.1495,2.1293,7.1685,2.1293,7.1685,2.2967,6.1495,2.2967],\"spans\":[{\"offset\":384,\"length\":16}]},{\"content\":\"מס׳ לקוח: 1340 ע.מ. לקוח: 513327064\",\"polygon\":[1.5767,2.1243,4.1318,2.1243,4.1318,2.3017,1.5767,2.3017],\"spans\":[{\"offset\":401,\"length\":35}]},{\"content\":\"הקטיף 11\",\"polygon\":[9.2978,2.3524,9.9112,2.3524,9.9112,2.5299,9.2978,2.5248],\"spans\":[{\"offset\":437,\"length\":8}]},{\"content\":\"הקטיף 11\",\"polygon\":[6.5906,2.3271,7.1736,2.3271,7.1736,2.4994,6.5906,2.4893],\"spans\":[{\"offset\":446,\"length\":8}]},{\"content\":\"מס׳ הזמנת לקוח: 2501005923\",\"polygon\":[2.3067,2.3169,4.1419,2.3169,4.1419,2.4944,2.3067,2.4944],\"spans\":[{\"offset\":455,\"length\":26}]},{\"content\":\"פארק תעשיות עמק חפר 3877701\",\"polygon\":[7.8479,2.5299,9.9163,2.5451,9.9163,2.7276,7.8479,2.7175],\"spans\":[{\"offset\":482,\"length\":27}]},{\"content\":\"פארק תעשיות עמק חפר 3877701\",\"polygon\":[5.1812,2.5045,7.1685,2.5096,7.1685,2.6921,5.1812,2.687],\"spans\":[{\"offset\":510,\"length\":27}]},{\"content\":\"מס׳ הזמנת פלסאון: 60000013\",\"polygon\":[2.3523,2.5096,4.1419,2.5096,4.1419,2.6769,2.3523,2.6769],\"spans\":[{\"offset\":538,\"length\":26}]},{\"content\":\"מס׳ תעודת משלוח: 108379736, 108379734,\",\"polygon\":[1.3942,2.6972,4.1318,2.6972,4.1369,2.8746,1.3942,2.8797],\"spans\":[{\"offset\":565,\"length\":38}]},{\"content\":\"108367753 ,108367755\",\"polygon\":[2.5501,2.8898,4.1267,2.8898,4.1267,3.0622,2.5501,3.0622],\"spans\":[{\"offset\":604,\"length\":20}]},{\"content\":\"מס׳ הקצאה: 301086521 20251028104848545\",\"polygon\":[1.1964,3.0825,4.1369,3.0876,4.1318,3.2599,1.1964,3.2498],\"spans\":[{\"offset\":625,\"length\":38}]},{\"content\":\"הערות:\",\"polygon\":[9.46,3.3816,9.9112,3.3867,9.9112,3.5185,9.46,3.5134],\"spans\":[{\"offset\":664,\"length\":6}]},{\"content\":\"מס׳\",\"polygon\":[9.6375,3.6959,9.8098,3.6959,9.8098,3.7973,9.6375,3.7923],\"spans\":[{\"offset\":671,\"length\":3}]},{\"content\":\"מק״ט לקוח\",\"polygon\":[8.6793,3.6909,9.2116,3.6909,9.2116,3.8125,8.6793,3.8176],\"spans\":[{\"offset\":675,\"length\":9}]},{\"content\":\"מק״ט פלסאון\",\"polygon\":[7.4322,3.6959,8.0608,3.6909,8.0608,3.8125,7.4322,3.8176],\"spans\":[{\"offset\":685,\"length\":11}]},{\"content\":\"תיאור\",\"polygon\":[5.7896,3.7111,6.0684,3.7111,6.0684,3.7973,5.7896,3.7973],\"spans\":[{\"offset\":697,\"length\":5}]},{\"content\":\"יח׳\",\"polygon\":[4.4461,3.6959,4.6033,3.6959,4.6033,3.7923,4.4461,3.7872],\"spans\":[{\"offset\":703,\"length\":3}]},{\"content\":\"כמות\",\"polygon\":[3.8479,3.7111,4.0862,3.7061,4.0862,3.7973,3.853,3.8024],\"spans\":[{\"offset\":707,\"length\":4}]},{\"content\":\"מחיר\",\"polygon\":[3.2091,3.7111,3.4423,3.7162,3.4423,3.7973,3.2091,3.7923],\"spans\":[{\"offset\":712,\"length\":4}]},{\"content\":\"סכום\",\"polygon\":[2.474,3.7162,2.7174,3.7162,2.7123,3.8024,2.474,3.7973],\"spans\":[{\"offset\":717,\"length\":4}]},{\"content\":\"אחוז\",\"polygon\":[1.7997,3.7111,2.0279,3.7061,2.0279,3.8024,1.8048,3.8024],\"spans\":[{\"offset\":722,\"length\":4}]},{\"content\":\"סכום\",\"polygon\":[1.0291,3.7162,1.2573,3.7111,1.2573,3.7973,1.0291,3.7973],\"spans\":[{\"offset\":727,\"length\":4}]},{\"content\":\"מידה\",\"polygon\":[4.3954,3.848,4.6388,3.848,4.6388,3.9393,4.3954,3.9342],\"spans\":[{\"offset\":732,\"length\":4}]},{\"content\":\"יח׳\",\"polygon\":[3.2649,3.8379,3.422,3.8379,3.422,3.9342,3.2649,3.9241],\"spans\":[{\"offset\":737,\"length\":3}]},{\"content\":\"ברוטו\",\"polygon\":[2.4588,3.8379,2.7376,3.848,2.7376,3.9494,2.4588,3.9393],\"spans\":[{\"offset\":741,\"length\":5}]},{\"content\":\"הנחה\",\"polygon\":[1.7845,3.848,2.038,3.848,2.038,3.9393,1.7845,3.9393],\"spans\":[{\"offset\":747,\"length\":4}]},{\"content\":\"נטו\",\"polygon\":[1.0697,3.848,1.2319,3.8531,1.2319,3.9444,1.0697,3.9393],\"spans\":[{\"offset\":752,\"length\":3}]},{\"content\":\"ב- ש״ח\",\"polygon\":[3.1584,3.9748,3.5234,3.9798,3.5234,4.0863,3.1584,4.0812],\"spans\":[{\"offset\":756,\"length\":6}]},{\"content\":\"ב-ש״ח\",\"polygon\":[2.4334,3.9798,2.763,3.9798,2.763,4.0812,2.4334,4.0812],\"spans\":[{\"offset\":763,\"length\":5}]},{\"content\":\"ב-ש״ח\",\"polygon\":[0.9784,3.9798,1.3181,3.9798,1.3181,4.0812,0.9784,4.0812],\"spans\":[{\"offset\":769,\"length\":5}]},{\"content\":\"1\",\"polygon\":[9.8453,4.2536,9.9112,4.2536,9.9112,4.3601,9.8453,4.3601],\"spans\":[{\"offset\":775,\"length\":1}]},{\"content\":\"33008600\",\"polygon\":[7.8529,4.2536,8.365,4.2536,8.365,4.3652,7.8529,4.3652],\"spans\":[{\"offset\":777,\"length\":8}]},{\"content\":\"מיכל דואון לבן מורכב\",\"polygon\":[6.0431,4.2486,6.9911,4.2486,6.9911,4.3702,6.0431,4.3753],\"spans\":[{\"offset\":786,\"length\":20}]},{\"content\":\"יחי\",\"polygon\":[4.5881,4.2638,4.7047,4.2638,4.7047,4.3652,4.5931,4.3652],\"spans\":[{\"offset\":807,\"length\":3}]},{\"content\":\"120\",\"polygon\":[3.9848,4.2587,4.1876,4.2536,4.1876,4.3601,3.9898,4.3601],\"spans\":[{\"offset\":811,\"length\":3}]},{\"content\":\"105.00\",\"polygon\":[3.2852,4.2536,3.6299,4.2536,3.6299,4.3652,3.2852,4.3601],\"spans\":[{\"offset\":815,\"length\":6}]},{\"content\":\"12,600.00\",\"polygon\":[2.398,4.2536,2.8999,4.2536,2.8999,4.3702,2.398,4.3702],\"spans\":[{\"offset\":822,\"length\":9}]},{\"content\":\"0.00\",\"polygon\":[1.9316,4.2536,2.1749,4.2536,2.1749,4.3652,1.9417,4.3652],\"spans\":[{\"offset\":832,\"length\":4}]},{\"content\":\"12,600.00\",\"polygon\":[1.019,4.2486,1.526,4.2486,1.526,4.3702,1.019,4.3652],\"spans\":[{\"offset\":837,\"length\":9}]},{\"content\":\"2\",\"polygon\":[9.8403,4.4057,9.9062,4.4057,9.9062,4.5071,9.8352,4.497],\"spans\":[{\"offset\":847,\"length\":1}]},{\"content\":\"33007400\",\"polygon\":[7.8529,4.3956,8.3701,4.4006,8.3701,4.5173,7.8529,4.5173],\"spans\":[{\"offset\":849,\"length\":8}]},{\"content\":\"מיכל קלסאון לבן מורכב\",\"polygon\":[5.967,4.4006,6.986,4.4006,6.986,4.5223,5.967,4.5223],\"spans\":[{\"offset\":858,\"length\":21}]},{\"content\":\"יחי\",\"polygon\":[4.5881,4.4108,4.7047,4.4159,4.7047,4.5071,4.5881,4.5071],\"spans\":[{\"offset\":880,\"length\":3}]},{\"content\":\"448\",\"polygon\":[3.9746,4.4006,4.1876,4.4057,4.1876,4.5122,3.9746,4.5122],\"spans\":[{\"offset\":884,\"length\":3}]},{\"content\":\"105.00\",\"polygon\":[3.2801,4.4006,3.6299,4.4006,3.6299,4.5173,3.2801,4.5122],\"spans\":[{\"offset\":888,\"length\":6}]},{\"content\":\"47,040.00\",\"polygon\":[2.3878,4.4006,2.8999,4.3956,2.8999,4.5173,2.3878,4.5173],\"spans\":[{\"offset\":895,\"length\":9}]},{\"content\":\"0.00\",\"polygon\":[1.9316,4.3956,2.1698,4.3956,2.1698,4.5122,1.9316,4.5122],\"spans\":[{\"offset\":905,\"length\":4}]},{\"content\":\"47,040.00\",\"polygon\":[1.0139,4.4006,1.5209,4.3956,1.526,4.5173,1.0139,4.5223],\"spans\":[{\"offset\":910,\"length\":9}]},{\"content\":\"3\",\"polygon\":[9.8352,4.5629,9.896,4.5578,9.9011,4.6643,9.8352,4.6592],\"spans\":[{\"offset\":920,\"length\":1}]},{\"content\":\"33008600\",\"polygon\":[7.8529,4.5477,8.365,4.5477,8.365,4.6643,7.8529,4.6643],\"spans\":[{\"offset\":922,\"length\":8}]},{\"content\":\"מיכל דואון לבן מורכב\",\"polygon\":[6.0279,4.5527,6.9962,4.5527,6.9962,4.6744,6.0279,4.6795],\"spans\":[{\"offset\":931,\"length\":20}]},{\"content\":\"יחי\",\"polygon\":[4.5881,4.5629,4.7047,4.5629,4.7047,4.6643,4.5881,4.6592],\"spans\":[{\"offset\":952,\"length\":3}]},{\"content\":\"600\",\"polygon\":[3.9797,4.5578,4.1876,4.5578,4.1876,4.6643,3.9848,4.6592],\"spans\":[{\"offset\":956,\"length\":3}]},{\"content\":\"105.00\",\"polygon\":[3.2852,4.5527,3.6299,4.5527,3.6248,4.6643,3.2852,4.6592],\"spans\":[{\"offset\":960,\"length\":6}]},{\"content\":\"63,000.00\",\"polygon\":[2.3828,4.5477,2.8948,4.5477,2.8948,4.6694,2.3828,4.6744],\"spans\":[{\"offset\":967,\"length\":9}]},{\"content\":\"0.00\",\"polygon\":[1.9366,4.5527,2.1648,4.5527,2.1698,4.6643,1.9417,4.6643],\"spans\":[{\"offset\":977,\"length\":4}]},{\"content\":\"63,000.00\",\"polygon\":[1.019,4.5527,1.5209,4.5477,1.5209,4.6694,1.019,4.6694],\"spans\":[{\"offset\":982,\"length\":9}]},{\"content\":\"4\",\"polygon\":[9.8352,4.7048,9.9011,4.7048,9.9062,4.8012,9.8352,4.8012],\"spans\":[{\"offset\":992,\"length\":1}]},{\"content\":\"33008600\",\"polygon\":[7.8479,4.6998,8.3701,4.7048,8.3701,4.8214,7.8479,4.8164],\"spans\":[{\"offset\":994,\"length\":8}]},{\"content\":\"מיכל דואון לבן מורכב\",\"polygon\":[6.0279,4.6998,6.9911,4.6998,6.9962,4.8265,6.0279,4.8316],\"spans\":[{\"offset\":1003,\"length\":20}]},{\"content\":\"יחי\",\"polygon\":[4.5881,4.72,4.7047,4.72,4.7047,4.8113,4.5881,4.8113],\"spans\":[{\"offset\":1024,\"length\":3}]},{\"content\":\"40\",\"polygon\":[4.0456,4.7048,4.1876,4.7048,4.1926,4.8113,4.0456,4.8113],\"spans\":[{\"offset\":1028,\"length\":2}]},{\"content\":\"105.00\",\"polygon\":[3.2852,4.6998,3.6248,4.7048,3.6248,4.8164,3.2852,4.8164],\"spans\":[{\"offset\":1031,\"length\":6}]},{\"content\":\"4,200.00\",\"polygon\":[2.4334,4.6998,2.8999,4.6998,2.8999,4.8214,2.4334,4.8214],\"spans\":[{\"offset\":1038,\"length\":8}]},{\"content\":\"0.00\",\"polygon\":[1.9316,4.7099,2.1648,4.7048,2.1648,4.8164,1.9366,4.8113],\"spans\":[{\"offset\":1047,\"length\":4}]},{\"content\":\"4,200.00\",\"polygon\":[1.0748,4.6795,1.4956,4.6744,1.5006,4.8417,1.0748,4.8468],\"spans\":[{\"offset\":1052,\"length\":8}]},{\"content\":\"לפירעון עד: 28/02/2026\",\"polygon\":[8.6235,5.3031,9.9163,5.3031,9.9163,5.4552,8.6235,5.4552],\"spans\":[{\"offset\":1061,\"length\":22}]},{\"content\":\"סה״כ ברוטו בש״ח:\",\"polygon\":[2.1343,5.3183,3.1381,5.3183,3.1381,5.4653,2.1343,5.4653],\"spans\":[{\"offset\":1084,\"length\":16}]},{\"content\":\"126,840.00\",\"polygon\":[1.0798,5.3234,1.6527,5.3234,1.6527,5.4552,1.0798,5.4552],\"spans\":[{\"offset\":1101,\"length\":10}]},{\"content\":\"תנאי תשלום: שוטף + 120\",\"polygon\":[8.6185,5.4704,9.9163,5.4704,9.9163,5.6225,8.6185,5.6174],\"spans\":[{\"offset\":1112,\"length\":22}]},{\"content\":\"הקמת הזמנה: Moshe, Megi\",\"polygon\":[8.4157,5.6276,9.9214,5.6326,9.9214,5.7898,8.4157,5.7847],\"spans\":[{\"offset\":1135,\"length\":23}]},{\"content\":\"סה״כ נטו:\",\"polygon\":[2.5906,5.5059,3.128,5.5059,3.128,5.6428,2.5906,5.6478],\"spans\":[{\"offset\":1159,\"length\":9}]},{\"content\":\"126,840.00\",\"polygon\":[1.0849,5.5059,1.6527,5.5059,1.6527,5.6377,1.0849,5.6377],\"spans\":[{\"offset\":1169,\"length\":10}]},{\"content\":\"הפקת חשבונית: Sharett, Yael\",\"polygon\":[8.3548,5.7898,9.9163,5.7949,9.9163,5.947,8.3548,5.9419],\"spans\":[{\"offset\":1180,\"length\":27}]},{\"content\":\"מע״מ 18%:\",\"polygon\":[2.4081,5.6935,3.1331,5.6935,3.1331,5.8354,2.4081,5.8405],\"spans\":[{\"offset\":1208,\"length\":9}]},{\"content\":\"22,831.20\",\"polygon\":[1.1305,5.6884,1.6527,5.6884,1.6527,5.8202,1.1305,5.8202],\"spans\":[{\"offset\":1218,\"length\":9}]},{\"content\":\"פלסאון בע״מ\",\"polygon\":[9.2167,5.947,9.9062,5.9419,9.9062,6.0991,9.2167,6.1041],\"spans\":[{\"offset\":1228,\"length\":11}]},{\"content\":\"סה״כ לתשלום בש״ח:\",\"polygon\":[2.0279,5.8608,3.1331,5.8608,3.1331,6.0179,2.0279,6.023],\"spans\":[{\"offset\":1240,\"length\":17}]},{\"content\":\"149,671.20\",\"polygon\":[1.09,5.8658,1.6578,5.8658,1.6578,5.9977,1.09,5.9977],\"spans\":[{\"offset\":1258,\"length\":10}]}],\"spans\":[{\"offset\":0,\"length\":1268}]}],\"tables\":[{\"rowCount\":5,\"columnCount\":9,\"cells\":[{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":0,\"content\":\"סכום\\nנטו\\nב-ש״ח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.701,3.6686,1.5924,3.6686,1.5924,4.2346,0.7074,4.2346]}],\"spans\":[{\"offset\":727,\"length\":4},{\"offset\":752,\"length\":3},{\"offset\":769,\"length\":5}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":1,\"content\":\"אחוז\\nהנחה\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5924,3.6686,2.2354,3.6686,2.2354,4.2346,1.5924,4.2346]}],\"spans\":[{\"offset\":722,\"length\":4},{\"offset\":747,\"length\":4}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":2,\"content\":\"סכום\\nברוטו\\nב-ש״ח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2354,3.6686,2.9613,3.6686,2.9676,4.23,2.2354,4.2346]}],\"spans\":[{\"offset\":717,\"length\":4},{\"offset\":741,\"length\":5},{\"offset\":763,\"length\":5}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":3,\"content\":\"מחיר\\nיח׳\\nב- ש״ח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9613,3.6686,3.6998,3.6686,3.6998,4.23,2.9676,4.23]}],\"spans\":[{\"offset\":712,\"length\":4},{\"offset\":737,\"length\":3},{\"offset\":756,\"length\":6}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":4,\"content\":\"כמות\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6998,3.6686,4.241,3.6686,4.2474,4.23,3.6998,4.23]}],\"spans\":[{\"offset\":707,\"length\":4}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":5,\"content\":\"תיאור\\nיח׳\\nמידה\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.241,3.6686,7.0615,3.6732,7.0679,4.23,4.2474,4.23]}],\"spans\":[{\"offset\":697,\"length\":9},{\"offset\":732,\"length\":4}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":6,\"content\":\"מק״ט פלסאון\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0615,3.6732,8.4431,3.6732,8.4431,4.23,7.0679,4.23]}],\"spans\":[{\"offset\":685,\"length\":11}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":7,\"content\":\"מק״ט לקוח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.4431,3.6732,9.4618,3.6732,9.4618,4.23,8.4431,4.23]}],\"spans\":[{\"offset\":675,\"length\":9}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":8,\"content\":\"מס׳\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.4618,3.6732,9.9775,3.6732,9.9775,4.23,9.4618,4.23]}],\"spans\":[{\"offset\":671,\"length\":3}]},{\"rowIndex\":1,\"columnIndex\":0,\"content\":\"12,600.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7074,4.2346,1.5924,4.2346,1.5924,4.3852,0.7138,4.3852]}],\"spans\":[{\"offset\":837,\"length\":9}]},{\"rowIndex\":1,\"columnIndex\":1,\"content\":\"0.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5924,4.2346,2.2354,4.2346,2.2354,4.3852,1.5924,4.3852]}],\"spans\":[{\"offset\":832,\"length\":4}]},{\"rowIndex\":1,\"columnIndex\":2,\"content\":\"12,600.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2354,4.2346,2.9676,4.23,2.9676,4.3852,2.2354,4.3852]}],\"spans\":[{\"offset\":822,\"length\":9}]},{\"rowIndex\":1,\"columnIndex\":3,\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9676,4.23,3.6998,4.23,3.6998,4.3852,2.9676,4.3852]}],\"spans\":[{\"offset\":815,\"length\":6}]},{\"rowIndex\":1,\"columnIndex\":4,\"content\":\"120\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6998,4.23,4.2474,4.23,4.2474,4.3852,3.6998,4.3852]}],\"spans\":[{\"offset\":811,\"length\":3}]},{\"rowIndex\":1,\"columnIndex\":5,\"content\":\"מיכל דואון לבן מורכב\\nיחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2474,4.23,7.0679,4.23,7.0679,4.3852,4.2474,4.3852]}],\"spans\":[{\"offset\":786,\"length\":24}]},{\"rowIndex\":1,\"columnIndex\":6,\"content\":\"33008600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0679,4.23,8.4431,4.23,8.4431,4.3852,7.0679,4.3852]}],\"spans\":[{\"offset\":777,\"length\":8}]},{\"rowIndex\":1,\"columnIndex\":7,\"content\":\"\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.4431,4.23,9.4618,4.23,9.4618,4.3852,8.4431,4.3852]}],\"spans\":[]},{\"rowIndex\":1,\"columnIndex\":8,\"content\":\"1\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.4618,4.23,9.9775,4.23,9.9775,4.3852,9.4618,4.3852]}],\"spans\":[{\"offset\":775,\"length\":1}]},{\"rowIndex\":2,\"columnIndex\":0,\"content\":\"47,040.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7138,4.3852,1.5924,4.3852,1.5924,4.5404,0.7138,4.5404]}],\"spans\":[{\"offset\":910,\"length\":9}]},{\"rowIndex\":2,\"columnIndex\":1,\"content\":\"0.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5924,4.3852,2.2354,4.3852,2.2354,4.5404,1.5924,4.5404]}],\"spans\":[{\"offset\":905,\"length\":4}]},{\"rowIndex\":2,\"columnIndex\":2,\"content\":\"47,040.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2354,4.3852,2.9676,4.3852,2.9676,4.5404,2.2354,4.5404]}],\"spans\":[{\"offset\":895,\"length\":9}]},{\"rowIndex\":2,\"columnIndex\":3,\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9676,4.3852,3.6998,4.3852,3.6998,4.5404,2.9676,4.5404]}],\"spans\":[{\"offset\":888,\"length\":6}]},{\"rowIndex\":2,\"columnIndex\":4,\"content\":\"448\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6998,4.3852,4.2474,4.3852,4.2474,4.5404,3.6998,4.5404]}],\"spans\":[{\"offset\":884,\"length\":3}]},{\"rowIndex\":2,\"columnIndex\":5,\"content\":\"מיכל קלסאון לבן מורכב\\nיחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2474,4.3852,7.0679,4.3852,7.0679,4.5404,4.2474,4.5404]}],\"spans\":[{\"offset\":858,\"length\":25}]},{\"rowIndex\":2,\"columnIndex\":6,\"content\":\"33007400\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0679,4.3852,8.4431,4.3852,8.4431,4.5404,7.0679,4.5404]}],\"spans\":[{\"offset\":849,\"length\":8}]},{\"rowIndex\":2,\"columnIndex\":7,\"content\":\"\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.4431,4.3852,9.4618,4.3852,9.4618,4.5404,8.4431,4.5404]}],\"spans\":[]},{\"rowIndex\":2,\"columnIndex\":8,\"content\":\"2\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.4618,4.3852,9.9775,4.3852,9.9775,4.5404,9.4618,4.5404]}],\"spans\":[{\"offset\":847,\"length\":1}]},{\"rowIndex\":3,\"columnIndex\":0,\"content\":\"63,000.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7138,4.5404,1.5924,4.5404,1.5924,4.6865,0.7138,4.6865]}],\"spans\":[{\"offset\":982,\"length\":9}]},{\"rowIndex\":3,\"columnIndex\":1,\"content\":\"0.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5924,4.5404,2.2354,4.5404,2.2354,4.6865,1.5924,4.6865]}],\"spans\":[{\"offset\":977,\"length\":4}]},{\"rowIndex\":3,\"columnIndex\":2,\"content\":\"63,000.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2354,4.5404,2.9676,4.5404,2.9676,4.6865,2.2354,4.6865]}],\"spans\":[{\"offset\":967,\"length\":9}]},{\"rowIndex\":3,\"columnIndex\":3,\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9676,4.5404,3.6998,4.5404,3.6998,4.6865,2.9676,4.6865]}],\"spans\":[{\"offset\":960,\"length\":6}]},{\"rowIndex\":3,\"columnIndex\":4,\"content\":\"600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6998,4.5404,4.2474,4.5404,4.2474,4.6865,3.6998,4.6865]}],\"spans\":[{\"offset\":956,\"length\":3}]},{\"rowIndex\":3,\"columnIndex\":5,\"content\":\"מיכל דואון לבן מורכב\\nיחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2474,4.5404,7.0679,4.5404,7.0679,4.6865,4.2474,4.6865]}],\"spans\":[{\"offset\":931,\"length\":24}]},{\"rowIndex\":3,\"columnIndex\":6,\"content\":\"33008600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0679,4.5404,8.4431,4.5404,8.4431,4.6865,7.0679,4.6865]}],\"spans\":[{\"offset\":922,\"length\":8}]},{\"rowIndex\":3,\"columnIndex\":7,\"content\":\"\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.4431,4.5404,9.4618,4.5404,9.4618,4.6865,8.4431,4.6865]}],\"spans\":[]},{\"rowIndex\":3,\"columnIndex\":8,\"content\":\"3\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.4618,4.5404,9.9775,4.5404,9.9775,4.6865,9.4618,4.6865]}],\"spans\":[{\"offset\":920,\"length\":1}]},{\"rowIndex\":4,\"columnIndex\":0,\"content\":\"4,200.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7138,4.6865,1.5924,4.6865,1.5924,4.8371,0.7138,4.8371]}],\"spans\":[{\"offset\":1052,\"length\":8}]},{\"rowIndex\":4,\"columnIndex\":1,\"content\":\"0.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5924,4.6865,2.2354,4.6865,2.2354,4.8371,1.5924,4.8371]}],\"spans\":[{\"offset\":1047,\"length\":4}]},{\"rowIndex\":4,\"columnIndex\":2,\"content\":\"4,200.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2354,4.6865,2.9676,4.6865,2.9676,4.8371,2.2354,4.8371]}],\"spans\":[{\"offset\":1038,\"length\":8}]},{\"rowIndex\":4,\"columnIndex\":3,\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9676,4.6865,3.6998,4.6865,3.6998,4.8371,2.9676,4.8371]}],\"spans\":[{\"offset\":1031,\"length\":6}]},{\"rowIndex\":4,\"columnIndex\":4,\"content\":\"40\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6998,4.6865,4.2474,4.6865,4.2474,4.8371,3.6998,4.8371]}],\"spans\":[{\"offset\":1028,\"length\":2}]},{\"rowIndex\":4,\"columnIndex\":5,\"content\":\"מיכל דואון לבן מורכב\\nיחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2474,4.6865,7.0679,4.6865,7.0679,4.8371,4.2474,4.8371]}],\"spans\":[{\"offset\":1003,\"length\":24}]},{\"rowIndex\":4,\"columnIndex\":6,\"content\":\"33008600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0679,4.6865,8.4431,4.6865,8.4431,4.8371,7.0679,4.8371]}],\"spans\":[{\"offset\":994,\"length\":8}]},{\"rowIndex\":4,\"columnIndex\":7,\"content\":\"\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.4431,4.6865,9.4618,4.6865,9.4618,4.8371,8.4431,4.8371]}],\"spans\":[]},{\"rowIndex\":4,\"columnIndex\":8,\"content\":\"4\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.4618,4.6865,9.9775,4.6865,9.9775,4.8371,9.4618,4.8371]}],\"spans\":[{\"offset\":992,\"length\":1}]}],\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.683,3.6668,9.9953,3.6683,9.9965,4.8568,0.6832,4.8552]}],\"spans\":[{\"offset\":727,\"length\":4},{\"offset\":752,\"length\":3},{\"offset\":769,\"length\":5},{\"offset\":722,\"length\":4},{\"offset\":747,\"length\":4},{\"offset\":717,\"length\":4},{\"offset\":741,\"length\":5},{\"offset\":763,\"length\":5},{\"offset\":712,\"length\":4},{\"offset\":737,\"length\":3},{\"offset\":756,\"length\":6},{\"offset\":707,\"length\":4},{\"offset\":697,\"length\":9},{\"offset\":732,\"length\":4},{\"offset\":685,\"length\":11},{\"offset\":675,\"length\":9},{\"offset\":671,\"length\":3},{\"offset\":837,\"length\":9},{\"offset\":832,\"length\":4},{\"offset\":822,\"length\":9},{\"offset\":815,\"length\":6},{\"offset\":811,\"length\":3},{\"offset\":786,\"length\":24},{\"offset\":777,\"length\":8},{\"offset\":775,\"length\":1},{\"offset\":910,\"length\":9},{\"offset\":905,\"length\":4},{\"offset\":895,\"length\":9},{\"offset\":888,\"length\":6},{\"offset\":884,\"length\":3},{\"offset\":858,\"length\":25},{\"offset\":849,\"length\":8},{\"offset\":847,\"length\":1},{\"offset\":982,\"length\":9},{\"offset\":977,\"length\":4},{\"offset\":967,\"length\":9},{\"offset\":960,\"length\":6},{\"offset\":956,\"length\":3},{\"offset\":931,\"length\":24},{\"offset\":922,\"length\":8},{\"offset\":920,\"length\":1},{\"offset\":1052,\"length\":8},{\"offset\":1047,\"length\":4},{\"offset\":1038,\"length\":8},{\"offset\":1031,\"length\":6},{\"offset\":1028,\"length\":2},{\"offset\":1003,\"length\":24},{\"offset\":994,\"length\":8},{\"offset\":992,\"length\":1}]}],\"styles\":[{\"confidence\":0.2,\"spans\":[{\"offset\":261,\"length\":1}],\"isHandwritten\":true}],\"documents\":[{\"docType\":\"invoice\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0,0,11.6806,0,11.6806,8.2639,0,8.2639]}],\"fields\":{\"CustomerAddress\":{\"type\":\"address\",\"content\":\"הקטיף 11\\nהקטיף 11\\nפארק תעשיות עמק חפר 3877701\\nפארק תעשיות עמק חפר 3877701\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[5.1827,2.3117,9.9192,2.3483,9.9162,2.7389,5.1797,2.7023]}],\"confidence\":0.321,\"spans\":[{\"offset\":437,\"length\":17},{\"offset\":482,\"length\":55}],\"valueAddress\":{\"houseNumber\":\"11\",\"road\":\"הקטיף\",\"streetAddress\":\"11 הקטיף\",\"house\":\"פארק תעשיות עמק חפר 3877701\\nפארק תעשיות עמק חפר 3877701\"}},\"CustomerAddressRecipient\":{\"type\":\"string\",\"valueString\":\"ט.פ.י פל-ים בע״מ\\nט.פ.י פל-ים בע״מ\",\"content\":\"ט.פ.י פל-ים בע״מ\\nט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[6.1597,2.1239,9.9214,2.1245,9.9214,2.3374,6.1597,2.3368]}],\"confidence\":0.455,\"spans\":[{\"offset\":367,\"length\":33}]},\"CustomerName\":{\"type\":\"string\",\"valueString\":\"ט.פ.י פל-ים בע״מ\\nט.פ.י פל-ים בע״מ\",\"content\":\"ט.פ.י פל-ים בע״מ\\nט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[6.1597,2.1239,9.9214,2.1245,9.9214,2.3374,6.1597,2.3368]}],\"confidence\":0.455,\"spans\":[{\"offset\":367,\"length\":33}]},\"CustomerTaxId\":{\"type\":\"string\",\"valueString\":\"513327064\",\"content\":\"513327064\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5868,2.1243,2.3168,2.1293,2.3118,2.3068,1.5817,2.3068]}],\"confidence\":0.713,\"spans\":[{\"offset\":427,\"length\":9}]},\"DueDate\":{\"type\":\"date\",\"valueDate\":\"2026-02-28\",\"content\":\"28/02/2026\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.6286,5.3082,9.242,5.3082,9.242,5.4603,8.6337,5.4552]}],\"confidence\":0.659,\"spans\":[{\"offset\":1073,\"length\":10}]},\"InvoiceDate\":{\"type\":\"date\",\"valueDate\":\"2025-10-26\",\"content\":\"26/10/2025\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.8441,1.9367,3.6248,1.9367,3.6248,2.104,2.8441,2.0989]}],\"confidence\":0.96,\"spans\":[{\"offset\":356,\"length\":10}]},\"InvoiceId\":{\"type\":\"string\",\"valueString\":\"258001605\",\"content\":\"258001605\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.4056,1.5869,5.308,1.5869,5.3029,1.7745,4.4005,1.7694]}],\"confidence\":0.959,\"spans\":[{\"offset\":303,\"length\":9}]},\"InvoiceTotal\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":149671.2,\"currencyCode\":\"ILS\"},\"content\":\"149,671.20\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.09,5.876,1.6578,5.8709,1.6527,6.0027,1.0951,5.9977]}],\"confidence\":0.961,\"spans\":[{\"offset\":1258,\"length\":10}]},\"Items\":{\"type\":\"array\",\"valueArray\":[{\"type\":\"object\",\"valueObject\":{\"Amount\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":12600,\"currencyCode\":\"ILS\"},\"content\":\"12,600.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.0241,4.2536,1.5209,4.2536,1.5209,4.3753,1.0291,4.3702]}],\"confidence\":0.887,\"spans\":[{\"offset\":837,\"length\":9}]},\"Description\":{\"type\":\"string\",\"valueString\":\"מיכל דואון לבן מורכב\",\"content\":\"מיכל דואון לבן מורכב\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[6.0684,4.2536,6.9962,4.2536,6.9962,4.3804,6.0684,4.3804]}],\"confidence\":0.931,\"spans\":[{\"offset\":786,\"length\":20}]},\"ProductCode\":{\"type\":\"string\",\"valueString\":\"33008600\",\"content\":\"33008600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.858,4.2587,8.3701,4.2536,8.3701,4.3702,7.8631,4.3652]}],\"confidence\":0.852,\"spans\":[{\"offset\":777,\"length\":8}]},\"Quantity\":{\"type\":\"number\",\"valueNumber\":120,\"content\":\"120\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.9949,4.2536,4.1673,4.2536,4.1673,4.3601,3.9949,4.3601]}],\"confidence\":0.879,\"spans\":[{\"offset\":811,\"length\":3}]},\"Unit\":{\"type\":\"string\",\"valueString\":\"יחי\",\"content\":\"יחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.5881,4.2638,4.7047,4.2638,4.7047,4.3652,4.5881,4.3652]}],\"confidence\":0.945,\"spans\":[{\"offset\":807,\"length\":3}]},\"UnitPrice\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":105,\"currencyCode\":\"ILS\"},\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.2852,4.2587,3.6299,4.2536,3.6299,4.3702,3.2902,4.3652]}],\"confidence\":0.883,\"spans\":[{\"offset\":815,\"length\":6}]}},\"content\":\"1\\n33008600\\nמיכל דואון לבן מורכב\\nיחי\\n120\\n105.00\\n12,600.00\\n0.00\\n12,600.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.0241,4.2536,9.9062,4.2536,9.9062,4.3804,1.0241,4.3804]}],\"confidence\":0.877,\"spans\":[{\"offset\":775,\"length\":71}]},{\"type\":\"object\",\"valueObject\":{\"Amount\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":47040,\"currencyCode\":\"ILS\"},\"content\":\"47,040.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.019,4.4006,1.5209,4.4006,1.5209,4.5173,1.019,4.5223]}],\"confidence\":0.886,\"spans\":[{\"offset\":910,\"length\":9}]},\"Description\":{\"type\":\"string\",\"valueString\":\"מיכל קלסאון לבן מורכב\",\"content\":\"מיכל קלסאון לבן מורכב\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[5.9822,4.4006,6.9911,4.4006,6.9911,4.5274,5.9822,4.5274]}],\"confidence\":0.931,\"spans\":[{\"offset\":858,\"length\":21}]},\"ProductCode\":{\"type\":\"string\",\"valueString\":\"33007400\",\"content\":\"33007400\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.858,4.4006,8.3701,4.4006,8.3701,4.5173,7.858,4.5173]}],\"confidence\":0.852,\"spans\":[{\"offset\":849,\"length\":8}]},\"Quantity\":{\"type\":\"number\",\"valueNumber\":448,\"content\":\"448\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.9797,4.4006,4.1774,4.4006,4.1774,4.5122,3.9797,4.5071]}],\"confidence\":0.886,\"spans\":[{\"offset\":884,\"length\":3}]},\"Unit\":{\"type\":\"string\",\"valueString\":\"יחי\",\"content\":\"יחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.5881,4.4108,4.7047,4.4108,4.6996,4.5071,4.5881,4.502]}],\"confidence\":0.943,\"spans\":[{\"offset\":880,\"length\":3}]},\"UnitPrice\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":105,\"currencyCode\":\"ILS\"},\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.2852,4.4006,3.6248,4.4006,3.6299,4.5173,3.2852,4.5122]}],\"confidence\":0.883,\"spans\":[{\"offset\":888,\"length\":6}]}},\"content\":\"2\\n33007400\\nמיכל קלסאון לבן מורכב\\nיחי\\n448\\n105.00\\n47,040.00\\n0.00\\n47,040.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.019,4.3956,9.9062,4.3956,9.9062,4.5274,1.019,4.5274]}],\"confidence\":0.877,\"spans\":[{\"offset\":847,\"length\":72}]},{\"type\":\"object\",\"valueObject\":{\"Amount\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":63000,\"currencyCode\":\"ILS\"},\"content\":\"63,000.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.019,4.5527,1.5209,4.5527,1.5209,4.6694,1.0241,4.6744]}],\"confidence\":0.886,\"spans\":[{\"offset\":982,\"length\":9}]},\"Description\":{\"type\":\"string\",\"valueString\":\"מיכל דואון לבן מורכב\",\"content\":\"מיכל דואון לבן מורכב\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[6.0684,4.5578,6.9962,4.5578,6.9962,4.6795,6.0684,4.6795]}],\"confidence\":0.931,\"spans\":[{\"offset\":931,\"length\":20}]},\"ProductCode\":{\"type\":\"string\",\"valueString\":\"33008600\",\"content\":\"33008600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.8529,4.5527,8.365,4.5527,8.365,4.6694,7.858,4.6694]}],\"confidence\":0.852,\"spans\":[{\"offset\":922,\"length\":8}]},\"Quantity\":{\"type\":\"number\",\"valueNumber\":600,\"content\":\"600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.9949,4.5578,4.1876,4.5578,4.1825,4.6643,3.9949,4.6643]}],\"confidence\":0.886,\"spans\":[{\"offset\":956,\"length\":3}]},\"Unit\":{\"type\":\"string\",\"valueString\":\"יחי\",\"content\":\"יחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.5881,4.5629,4.7047,4.5629,4.6996,4.6643,4.5881,4.6592]}],\"confidence\":0.945,\"spans\":[{\"offset\":952,\"length\":3}]},\"UnitPrice\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":105,\"currencyCode\":\"ILS\"},\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.2852,4.5527,3.6299,4.5527,3.6299,4.6694,3.2902,4.6643]}],\"confidence\":0.883,\"spans\":[{\"offset\":960,\"length\":6}]}},\"content\":\"3\\n33008600\\nמיכל דואון לבן מורכב\\nיחי\\n600\\n105.00\\n63,000.00\\n0.00\\n63,000.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.019,4.5477,9.9011,4.5477,9.9011,4.6795,1.019,4.6795]}],\"confidence\":0.877,\"spans\":[{\"offset\":920,\"length\":71}]},{\"type\":\"object\",\"valueObject\":{\"Amount\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":4200,\"currencyCode\":\"ILS\"},\"content\":\"4,200.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.0748,4.6744,1.4956,4.6744,1.5006,4.8417,1.0748,4.8468]}],\"confidence\":0.91,\"spans\":[{\"offset\":1052,\"length\":8}]},\"Description\":{\"type\":\"string\",\"valueString\":\"מיכל דואון לבן מורכב\",\"content\":\"מיכל דואון לבן מורכב\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[6.0684,4.7048,6.9911,4.7048,6.9911,4.8367,6.0684,4.8367]}],\"confidence\":0.93,\"spans\":[{\"offset\":1003,\"length\":20}]},\"ProductCode\":{\"type\":\"string\",\"valueString\":\"33008600\",\"content\":\"33008600\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.8479,4.7048,8.3701,4.7099,8.3701,4.8265,7.8529,4.8214]}],\"confidence\":0.852,\"spans\":[{\"offset\":994,\"length\":8}]},\"Quantity\":{\"type\":\"number\",\"valueNumber\":40,\"content\":\"40\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.0456,4.7048,4.1825,4.7048,4.1825,4.8113,4.0456,4.8113]}],\"confidence\":0.886,\"spans\":[{\"offset\":1028,\"length\":2}]},\"Unit\":{\"type\":\"string\",\"valueString\":\"יחי\",\"content\":\"יחי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.5881,4.72,4.7047,4.72,4.7047,4.8113,4.5881,4.8113]}],\"confidence\":0.959,\"spans\":[{\"offset\":1024,\"length\":3}]},\"UnitPrice\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":105,\"currencyCode\":\"ILS\"},\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.2852,4.7048,3.6248,4.7048,3.6248,4.8214,3.2852,4.8214]}],\"confidence\":0.883,\"spans\":[{\"offset\":1031,\"length\":6}]}},\"content\":\"4\\n33008600\\nמיכל דואון לבן מורכב\\nיחי\\n40\\n105.00\\n4,200.00\\n0.00\\n4,200.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.0748,4.6744,9.9062,4.6744,9.9062,4.8468,1.0748,4.8468]}],\"confidence\":0.877,\"spans\":[{\"offset\":992,\"length\":68}]}]},\"PaymentTerm\":{\"type\":\"string\",\"valueString\":\"שוטף + 120\",\"content\":\"שוטף + 120\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.6235,5.4755,9.1964,5.4755,9.1964,5.6225,8.6235,5.6225]}],\"confidence\":0.812,\"spans\":[{\"offset\":1124,\"length\":10}]},\"SubTotal\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":126840,\"currencyCode\":\"ILS\"},\"content\":\"126,840.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.09,5.516,1.6527,5.5059,1.6527,5.6428,1.0951,5.6326]}],\"confidence\":0.867,\"spans\":[{\"offset\":1169,\"length\":10}]},\"TotalTax\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":22831.2,\"currencyCode\":\"ILS\"},\"content\":\"22,831.20\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.1356,5.6935,1.6527,5.6935,1.6527,5.8253,1.1407,5.8202]}],\"confidence\":0.963,\"spans\":[{\"offset\":1218,\"length\":9}]},\"VendorName\":{\"type\":\"string\",\"valueString\":\"PLASSON®\",\"content\":\"PLASSON®\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.1559,0.5678,2.1495,0.5628,2.1546,0.7149,1.1559,0.7453]}],\"confidence\":0.937,\"spans\":[{\"offset\":263,\"length\":8}]}},\"confidence\":1,\"spans\":[{\"offset\":0,\"length\":1268}]}]}}"
            }
        ],
        "language": "javascript",
        "inputFormat": "editor",
        "dependencies": [],
        "codeEditorJavascript": "// ============================================================================\n// קוד 2 - עיבוד חשבוניות (גרסה 4.2 - תיקון מחיר)\n// מקבל: OCR + הגדרות + תעודות + יבוא\n// מחזיר: JSON לפריוריטי + דוח ביצוע\n//\n// ✨ חדש בגרסה 4.2:\n// - תיקון חישוב מחיר: InvoiceTotal - TotalTax = סה\"כ לפני מע\"מ (עבודות + חלקים)\n//\n// ✨ חדש בגרסה 4.1:\n// - פונקציית cleanInvoiceForPriority() - מנקה שדות למידה לפני שליחה\n// - זיהוי רכבים משופר - מונע זיהוי כרטיס כרכב\n//\n// ✨ חדש בגרסה 4.0:\n// - חילוץ רכבים מתקדם לפי vehicle_processing_rules.search_locations\n// - תמיכה ב-VehicleNumbers (שדה חדש מ-Azure v3.0)\n// - תמיכה ב-Items[].VehicleNumber (קישור ישיר)\n// - יצירת פריטי רכבים אוטומטית\n// - מיפוי לחשבונות לפי vehicle_account_mapping\n//\n// ✨ מגרסה 3.0:\n// - תמיכה במבנה החדש של UnidentifiedNumbers (מערך אובייקטים)\n// - ניצול התוויות (label) וההקשר (context) לזיהוי חכם יותר\n// ============================================================================\n\n// ============================================================================\n// פונקציית עזר - ניקוי invoice לפני שליחה ל-Priority\n// ============================================================================\n\nfunction cleanInvoiceForPriority(invoice) {\n    // יצירת עותק עמוק כדי לא לשנות את המקור\n    const cleaned = JSON.parse(JSON.stringify(invoice));\n\n    // ניקוי שדות שלא צריכים מהפריטים\n    if (cleaned.PINVOICEITEMS_SUBFORM) {\n        cleaned.PINVOICEITEMS_SUBFORM = cleaned.PINVOICEITEMS_SUBFORM.map(item => {\n            // מחיקת שדות למידה\n            delete item.isNewVehicle;\n            delete item._learningNote;\n\n            // מחיקת SPECIALVATFLAG אם זה לא \"Y\"\n            if (item.SPECIALVATFLAG && item.SPECIALVATFLAG !== \"Y\") {\n                delete item.SPECIALVATFLAG;\n            }\n\n            return item;\n        });\n    }\n\n    return cleaned;\n}\n\n// ============================================================================\n// פונקציה ראשית\n// ============================================================================\n\nfunction processInvoiceComplete(input) {\n    const executionReport = {\n        stage: \"\",\n        found: [],\n        not_found: [],\n        warnings: [],\n        errors: []\n    };\n\n    try {\n        // ============================================================================\n        // שלב 1: זיהוי סוג חשבונית ותבנית\n        // ============================================================================\n\n        executionReport.stage = \"שלב 1: זיהוי סוג ותבנית\";\n\n        // א. בדיקת יבוא\n        const hasImport = checkImportExists(input.import_files);\n\n        // ב. בדיקת תעודות - ב-OCR!\n        const hasDocs = checkDocsInOCR(\n            input.AZURE_RESULT.data.fields,\n            input.AZURE_TEXT\n        );\n\n        // ג. זיהוי חיוב/זיכוי\n        const debitType = identifyDebitType(input.AZURE_RESULT.data.fields);\n\n        executionReport.found.push(`סוג: יבוא=${hasImport}, תעודות=${hasDocs}, חיוב/זיכוי=${debitType}`);\n\n        // ד. חיפוש תבנית מתאימה\n        const config = input.learned_config.config;\n        const templateIndex = findMatchingTemplate(config.structure, hasImport, hasDocs, debitType);\n\n        if (templateIndex === -1) {\n            executionReport.errors.push(\"לא נמצאה תבנית מתאימה!\");\n            throw new Error(\"לא נמצאה תבנית מתאימה\");\n        }\n\n        const structure = config.structure[templateIndex];\n        const template = input.learned_config.template.PINVOICES[templateIndex];\n\n        executionReport.found.push(`תבנית: index=${templateIndex}`);\n\n        // ============================================================================\n        // שלב 2: הכנה - הבנת דפוסים\n        // ============================================================================\n\n        executionReport.stage = \"שלב 2: הבנת דפוסים\";\n\n        const patterns = extractPatterns(\n            input.learned_config.recommended_samples,\n            input.docs_list\n        );\n\n        executionReport.found.push(`דפוסים: BOOKNUM=${JSON.stringify(patterns.booknum_pattern)}, תעודות=${JSON.stringify(patterns.docs_pattern)}`);\n\n        // ✨ חדש! קריאת חוקי רכבים\n        const vehicleRules = config.rules?.critical_patterns?.vehicle_rules || null;\n        if (vehicleRules && vehicleRules.enabled) {\n            executionReport.found.push(`חוקי רכבים: פעילים (${Object.keys(vehicleRules.vehicle_account_mapping || {}).length} רכבים ממופים)`);\n        }\n\n        // ============================================================================\n        // שלב 3: חיפוש וזיהוי נתונים\n        // ============================================================================\n\n        executionReport.stage = \"שלב 3: חיפוש נתונים\";\n\n        const ocrFields = input.AZURE_RESULT.data.fields;\n        const searchResults = searchAllData(\n            ocrFields,\n            input.AZURE_TEXT,\n            patterns,\n            structure,\n            input.import_files,\n            input.docs_list,\n            vehicleRules  // ✨ חדש!\n        );\n\n        // תיעוד מה נמצא\n        Object.keys(searchResults).forEach(key => {\n            if (key === 'documents' && searchResults.documents) {\n                if (searchResults.documents.length > 0) {\n                    const docsInfo = searchResults.documents.map(d =>\n                        `${d.BOOKNUM} (DOCNO: ${d.DOCNO || 'ריק'})`\n                    ).join(', ');\n                    executionReport.found.push(`תעודות: ${searchResults.documents.length} - ${docsInfo}`);\n                } else {\n                    executionReport.not_found.push('תעודות');\n                }\n            } else if (key === 'vehicles' && searchResults.vehicles) {\n                if (searchResults.vehicles.length > 0) {\n                    executionReport.found.push(`רכבים: ${searchResults.vehicles.length} - ${searchResults.vehicles.join(', ')}`);\n                } else {\n                    executionReport.not_found.push('רכבים');\n                }\n            } else if (searchResults[key]) {\n                executionReport.found.push(`${key}: ${JSON.stringify(searchResults[key]).substring(0, 50)}`);\n            } else {\n                executionReport.not_found.push(key);\n            }\n        });\n\n        // ============================================================================\n        // שלב 4: בניית JSON\n        // ============================================================================\n\n        executionReport.stage = \"שלב 4: בניית חשבונית\";\n\n        const invoice = buildInvoiceFromTemplate(\n            template,\n            structure,\n            config,\n            searchResults,\n            input.learned_config,\n            ocrFields  // ✨ חדש! מעביר גם את ocrFields\n        );\n\n        // ============================================================================\n        // שלב 5: בקרות\n        // ============================================================================\n\n        executionReport.stage = \"שלב 5: בקרות\";\n\n        const validation = performValidation(\n            invoice,\n            ocrFields,\n            config,\n            input.docs_list,\n            patterns\n        );\n\n        // ============================================================================\n        // שלב 6: ניתוח למידה\n        // ============================================================================\n\n        executionReport.stage = \"שלב 6: ניתוח למידה\";\n\n        const learningAnalysis = analyzeLearning(invoice, config);\n\n        // ============================================================================\n        // שלב 7: ניקוי והחזרת תוצאה\n        // ============================================================================\n\n        // ניקוי שדות שלא צריכים (למידה בלבד, לא ל-Priority)\n        const cleanedInvoice = cleanInvoiceForPriority(invoice);\n\n        // ============================================================================\n        // שלב 8: יצירת 2 פלטים נוספים\n        // ============================================================================\n\n        // פלט 1: הנחיות ל-LLM (פרומפט בשפה טבעית)\n        const llmPrompt = generateLLMPrompt(config, ocrFields, searchResults, executionReport);\n\n        // פלט 2: קונפיג טכני למערכת\n        const technicalConfig = generateTechnicalConfig(config, ocrFields, searchResults, executionReport);\n\n        // פלט 3: סצנריו עיבוד - מה MAKE צריך לשלוף מהמערכת\n        const hasVehicles = vehicleRules &&\n                           vehicleRules.vehicle_account_mapping &&\n                           Object.keys(vehicleRules.vehicle_account_mapping).length > 0;\n\n        const processingScenario = {\n            check_docs: structure.has_doc || false,\n            check_import: structure.has_import || false,\n            check_vehicles: hasVehicles || false\n        };\n\n        return {\n            status: \"success\",\n\n            // 1. JSON לפריוריטי (הפלט העיקרי)\n            invoice_data: {\n                PINVOICES: [cleanedInvoice]\n            },\n\n            // 2. הנחיות ל-LLM (פרומפט בשפה טבעית)\n            llm_prompt: llmPrompt,\n\n            // 3. קונפיג טכני למערכת\n            technical_config: technicalConfig,\n\n            // 4. סצנריו עיבוד - מה צריך לשלוף מהמערכת\n            processing_scenario: processingScenario\n        };\n\n    } catch (error) {\n        return {\n            status: \"error\",\n            error_type: error.name || \"ProcessingError\",\n            message: error.message\n        };\n    }\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 1\n// ============================================================================\n\nfunction checkImportExists(importFiles) {\n    if (!importFiles || !importFiles.IMPFILES) return false;\n    if (importFiles.IMPFILES.length === 0) return false;\n\n    try {\n        const parsed = JSON.parse('[' + importFiles.IMPFILES[0] + ']');\n        return parsed.length > 0 && parsed[0].IMPFNUM;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction checkDocsExist(docsList) {\n    if (!docsList || docsList.DOC_YES_NO !== \"Y\") return false;\n    return docsList.list_of_docs && docsList.list_of_docs.length > 0;\n}\n\nfunction checkDocsInOCR(ocrFields, azureText) {\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n    const docPattern = /^25\\d{6}$/;\n\n    let foundInUnidentified = false;\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            foundInUnidentified = unidentified.some(item =>\n                docPattern.test(item.value)\n            );\n        } else {\n            foundInUnidentified = unidentified.some(num =>\n                docPattern.test(num)\n            );\n        }\n    }\n\n    if (foundInUnidentified) return true;\n\n    if (azureText) {\n        const matches = azureText.match(/25\\d{6}/g);\n        if (matches && matches.length > 0) return true;\n    }\n\n    return false;\n}\n\nfunction identifyDebitType(ocrFields) {\n    const total = ocrFields.InvoiceTotal || ocrFields.InvoiceTotal_amount || 0;\n    return total >= 0 ? \"D\" : \"C\";\n}\n\nfunction findMatchingTemplate(structures, hasImport, hasDocs, debitType) {\n    return structures.findIndex(s =>\n        s.has_import === hasImport &&\n        s.has_doc === hasDocs &&\n        s.debit_type === debitType\n    );\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 2\n// ============================================================================\n\nfunction extractPatterns(recommendedSamples, docsList) {\n    const patterns = {\n        booknum_pattern: null,\n        ivnum_pattern: null,\n        docs_pattern: null,\n        docs_totquant: {}\n    };\n\n    if (recommendedSamples && recommendedSamples.samples && recommendedSamples.samples.length > 0) {\n        const sample = recommendedSamples.samples[0];\n\n        if (sample.sample_booknum) {\n            patterns.booknum_pattern = {\n                length: sample.sample_booknum.length,\n                example: sample.sample_booknum\n            };\n        }\n\n        if (sample.sample_ivnum) {\n            patterns.ivnum_pattern = {\n                length: sample.sample_ivnum.length,\n                example: sample.sample_ivnum\n            };\n        }\n    }\n\n    if (docsList && docsList.list_of_docs && docsList.list_of_docs.length > 0) {\n        try {\n            const docs = docsList.list_of_docs.map(d => JSON.parse(d));\n\n            if (docs.length > 0) {\n                const firstDoc = docs[0];\n                patterns.docs_pattern = {\n                    booknum_example: firstDoc.BOOKNUM,\n                    docno_example: firstDoc.DOCNO\n                };\n\n                docs.forEach(doc => {\n                    if (doc.TOTQUANT) {\n                        patterns.docs_totquant[doc.BOOKNUM] = doc.TOTQUANT;\n                    }\n                });\n            }\n        } catch (e) {\n            // שגיאה בפרסור\n        }\n    }\n\n    return patterns;\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 3\n// ============================================================================\n\nfunction searchAllData(ocrFields, azureText, patterns, structure, importFiles, docsList, vehicleRules) {\n    return {\n        booknum: searchBooknum(ocrFields, patterns),\n        ivdate: searchIvdate(ocrFields),\n        details: searchDetails(ocrFields, azureText),\n        ordname: structure.has_purchase_orders || structure.has_import ? searchOrdname(ocrFields) : null,\n        impfnum: structure.has_import ? searchImpfnum(ocrFields, importFiles) : null,\n        documents: structure.has_doc ? searchDocuments(ocrFields, azureText, patterns, docsList) : null,\n        vehicles: vehicleRules ? extractVehiclesAdvanced(ocrFields, vehicleRules) : [],  // ✨ חדש!\n        items: ocrFields.Items || []\n    };\n}\n\nfunction searchBooknum(ocrFields, patterns) {\n    let booknum = ocrFields.InvoiceId || \"\";\n\n    booknum = String(booknum).replace(/^SI/i, '');\n\n    if (patterns.booknum_pattern) {\n        const expectedLength = patterns.booknum_pattern.length;\n        if (booknum.length > expectedLength) {\n            booknum = booknum.slice(-expectedLength);\n        }\n    }\n\n    return booknum;\n}\n\nfunction searchIvdate(ocrFields) {\n    const isoDate = ocrFields.InvoiceDate;\n    if (!isoDate) return \"\";\n\n    const date = new Date(isoDate);\n    const day = String(date.getDate()).padStart(2, '0');\n    const month = String(date.getMonth() + 1).padStart(2, '0');\n    const year = String(date.getFullYear()).slice(-2);\n\n    return `${day}/${month}/${year}`;\n}\n\nfunction searchDetails(ocrFields, azureText) {\n    if (ocrFields.InvoiceDescription) {\n        return ocrFields.InvoiceDescription;\n    }\n\n    if (azureText) {\n        const lines = azureText.split('\\n').filter(l => l.trim());\n        if (lines.length > 2) {\n            return lines[2].substring(0, 100);\n        }\n    }\n\n    return \"\";\n}\n\nfunction searchOrdname(ocrFields) {\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n    const ordPattern = /^\\d{10}$/;\n    let found = \"\";\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            const orderItem = unidentified.find(item =>\n                item.label && (\n                    item.label.includes('הזמנה') ||\n                    item.label.toLowerCase().includes('order') ||\n                    item.label.toLowerCase().includes('po')\n                ) && ordPattern.test(item.value)\n            );\n\n            if (orderItem) {\n                found = orderItem.value;\n            } else {\n                const anyOrder = unidentified.find(item =>\n                    ordPattern.test(item.value)\n                );\n                found = anyOrder ? anyOrder.value : \"\";\n            }\n        } else {\n            const match = unidentified.find(num => ordPattern.test(num));\n            found = match || \"\";\n        }\n    }\n\n    return found;\n}\n\nfunction searchImpfnum(ocrFields, importFiles) {\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n    const impPattern = /^\\d{2}c\\d{5}$/;\n    let foundInOCR = \"\";\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            const importItem = unidentified.find(item =>\n                item.label && (\n                    item.label.includes('יבוא') ||\n                    item.label.toLowerCase().includes('import') ||\n                    item.label.includes('IMPFNUM')\n                ) && impPattern.test(item.value)\n            );\n\n            if (importItem) {\n                foundInOCR = importItem.value;\n            } else {\n                const anyImport = unidentified.find(item =>\n                    impPattern.test(item.value)\n                );\n                foundInOCR = anyImport ? anyImport.value : \"\";\n            }\n        } else {\n            const match = unidentified.find(num => impPattern.test(num));\n            foundInOCR = match || \"\";\n        }\n    }\n\n    if (foundInOCR) return foundInOCR;\n\n    if (importFiles && importFiles.IMPFILES && importFiles.IMPFILES.length > 0) {\n        try {\n            const parsed = JSON.parse('[' + importFiles.IMPFILES[0] + ']');\n            if (parsed.length > 0 && parsed[0].IMPFNUM) {\n                return parsed[0].IMPFNUM;\n            }\n        } catch (e) {\n            // ממשיכים בלי\n        }\n    }\n\n    return \"\";\n}\n\nfunction searchDocuments(ocrFields, azureText, patterns, docsList) {\n    const foundDocs = [];\n\n    if (!docsList || !docsList.list_of_docs || docsList.list_of_docs.length === 0) {\n        return foundDocs;\n    }\n\n    let availableDocs = [];\n    try {\n        availableDocs = docsList.list_of_docs.map(d => JSON.parse(d));\n    } catch (e) {\n        return foundDocs;\n    }\n\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            for (const item of unidentified) {\n                const match = availableDocs.find(doc => doc.BOOKNUM === item.value);\n\n                if (match) {\n                    foundDocs.push({\n                        DOCNO: match.DOCNO,\n                        BOOKNUM: match.BOOKNUM,\n                        TOTQUANT: match.TOTQUANT || null\n                    });\n                }\n            }\n        } else {\n            for (const num of unidentified) {\n                const match = availableDocs.find(doc => doc.BOOKNUM === num);\n\n                if (match) {\n                    foundDocs.push({\n                        DOCNO: match.DOCNO,\n                        BOOKNUM: match.BOOKNUM,\n                        TOTQUANT: match.TOTQUANT || null\n                    });\n                }\n            }\n        }\n    }\n\n    if (foundDocs.length === 0 && azureText) {\n        for (const doc of availableDocs) {\n            if (azureText.includes(doc.BOOKNUM)) {\n                foundDocs.push({\n                    DOCNO: doc.DOCNO,\n                    BOOKNUM: doc.BOOKNUM,\n                    TOTQUANT: doc.TOTQUANT || null\n                });\n            }\n        }\n    }\n\n    return foundDocs;\n}\n\n// ============================================================================\n// ✨ חדש! פונקציות חילוץ רכבים מתקדם\n// ============================================================================\n\nfunction extractVehiclesAdvanced(ocrFields, vehicleRules) {\n    // תיקון: בדוק אם יש vehicle_account_mapping במקום enabled\n    if (!vehicleRules || !vehicleRules.vehicle_account_mapping) return [];\n\n    const foundVehicles = [];\n    // תיקון: אם אין search_locations, השתמש בברירת מחדל\n    const searchLocations = vehicleRules.search_locations || [\n        {\n            location: \"fields.UnidentifiedNumbers\",\n            priority: 1,\n            filter_by_label: \"רכב\",\n            description: \"חיפוש רכבים ב-UnidentifiedNumbers עם תווית רכב\"\n        }\n    ];\n\n    // סדר לפי עדיפות\n    const sortedLocations = [...searchLocations].sort((a, b) => a.priority - b.priority);\n\n    for (const location of sortedLocations) {\n        if (location.location === \"fields.VehicleNumbers\") {\n            // 1. רשימה מוכנה מאז'ור\n            if (ocrFields.VehicleNumbers && Array.isArray(ocrFields.VehicleNumbers)) {\n                ocrFields.VehicleNumbers.forEach(vNum => {\n                    if (!foundVehicles.includes(vNum)) {\n                        foundVehicles.push(vNum);\n                    }\n                });\n            }\n        }\n        else if (location.location === \"fields.Items[].VehicleNumber\") {\n            // 2. קישור ישיר בפריט\n            if (ocrFields.Items && Array.isArray(ocrFields.Items)) {\n                ocrFields.Items.forEach(item => {\n                    if (item.VehicleNumber && !foundVehicles.includes(item.VehicleNumber)) {\n                        foundVehicles.push(item.VehicleNumber);\n                    }\n                });\n            }\n        }\n        else if (location.location === \"fields.Items[].Description\" && location.pattern) {\n            // 3. חיפוש בתיאור לפי דפוס\n            if (ocrFields.Items && Array.isArray(ocrFields.Items)) {\n                const pattern = new RegExp(location.pattern);\n                ocrFields.Items.forEach(item => {\n                    if (item.Description) {\n                        const match = item.Description.match(pattern);\n                        if (match && match[0] && !foundVehicles.includes(match[0])) {\n                            foundVehicles.push(match[0]);\n                        }\n                    }\n                });\n            }\n        }\n        else if (location.location === \"fields.UnidentifiedNumbers\") {\n            // 4. מספרים לא מזוהים\n            const unidentified = ocrFields.UnidentifiedNumbers || [];\n            const vehiclePattern = /\\d{3}-\\d{2}-\\d{3}/;\n\n            unidentified.forEach(item => {\n                const value = typeof item === 'object' ? item.value : item;\n                const label = typeof item === 'object' ? (item.label || '') : '';\n                const context = typeof item === 'object' ? (item.context || '') : '';\n\n                // תיקון: גם אם יש תווית \"רכב\", חייב להתאים לדפוס מספר רכב!\n                // זה מונע טעויות של Azure OCR שמסמן מספר כרטיס בתור \"מספר רכב\"\n                const isValidVehicleNumber = vehiclePattern.test(value);\n\n                // בדיקה נוספת: אם בהקשר כתוב \"כרטיס\", זה לא רכב\n                const looksLikeCardNumber = context.includes('כרטיס') || label.includes('כרטיס');\n\n                // אם יש filter_by_label - רק עם התווית הזו וגם דפוס תקין\n                if (location.filter_by_label) {\n                    if (label && label.includes(location.filter_by_label)) {\n                        // תיקון: גם עם תווית רכב, חייב דפוס תקין ולא להיות מסומן ככרטיס\n                        if (isValidVehicleNumber && !looksLikeCardNumber && !foundVehicles.includes(value)) {\n                            foundVehicles.push(value);\n                        }\n                    }\n                } else {\n                    // אחרת - לפי דפוס רכב בלבד\n                    if (isValidVehicleNumber && !looksLikeCardNumber && !foundVehicles.includes(value)) {\n                        foundVehicles.push(value);\n                    }\n                }\n            });\n        }\n    }\n\n    return [...new Set(foundVehicles)]; // ייחודיים בלבד\n}\n\nfunction createVehicleItems(vehicles, ocrItems, vehicleRules, ocrFields) {\n    if (!vehicles || vehicles.length === 0) return [];\n\n    const vehicleItems = [];\n\n    // תיקון: מחיר = סכום כל החשבונית (לפני מע\"מ)\n    // חישוב: InvoiceTotal - TotalTax = סה\"כ לפני מע\"מ (עבודות + חלקים)\n    const totalPrice = ocrFields.TotalTax_amount\n        ? (ocrFields.InvoiceTotal_amount || 0) - ocrFields.TotalTax_amount\n        : (ocrFields.SubTotal_amount || ocrFields.InvoiceTotal_amount || 0);\n    const pricePerVehicle = vehicles.length > 0 ? totalPrice / vehicles.length : totalPrice;\n\n    vehicles.forEach(vehicleNum => {\n        // חיפוש מיפוי בחוקים\n        const mapping = vehicleRules.vehicle_account_mapping?.[vehicleNum];\n\n        // חיפוש תיאור מהפריטים של OCR\n        const relatedItem = ocrItems.find(item =>\n            (item.VehicleNumber && item.VehicleNumber === vehicleNum) ||\n            (item.Description && item.Description.includes(vehicleNum))\n        );\n\n        // תיקון: תיאור קצר בלבד\n        const shortDesc = extractShortDescription(ocrFields, vehicleNum);\n\n        // בניית פריט - רק שדות שPriority מכיר!\n        const item = {\n            PARTNAME: vehicleRules.output_format?.partname || \"car\",\n            PDES: shortDesc,\n            TQUANT: relatedItem?.Quantity || 1,\n            TUNITNAME: relatedItem?.Unit || \"יח'\",\n            PRICE: pricePerVehicle,\n            VATFLAG: mapping?.vat_pattern?.VATFLAG || \"Y\",\n            ACCNAME: mapping?.accname || vehicleRules.default_values?.accname || \"\"\n        };\n\n        // BUDCODE - חובה לפי התבנית!\n        if (mapping?.budcode) {\n            item.BUDCODE = mapping.budcode;\n        } else if (vehicleRules.default_values?.budcode) {\n            item.BUDCODE = vehicleRules.default_values.budcode;\n        }\n\n        // SPECIALVATFLAG - רק אם זה Y (לא שדות אחרים!)\n        if (mapping?.vat_pattern?.SPECIALVATFLAG === \"Y\") {\n            item.SPECIALVATFLAG = \"Y\";\n        }\n\n        // שמור מידע למידה בנפרד (לא נשלח ל-Priority!)\n        if (!mapping) {\n            // רק לצרכי דיווח ולמידה - לא ישלח ב-JSON הסופי\n            item._learningNote = \"רכב חדש - נדרש מיפוי\";\n        }\n\n        vehicleItems.push(item);\n    });\n\n    return vehicleItems;\n}\n\n// ============================================================================\n// פונקציית עזר - חילוץ תיאור קצר\n// ============================================================================\n\nfunction extractShortDescription(ocrFields, vehicleNum) {\n    // חיפוש תיאור קצר מהפריטים\n    if (ocrFields.Items && ocrFields.Items.length > 0) {\n        // חפש פריט שמכיל תיאור רלוונטי\n        const item = ocrFields.Items.find(i =>\n            i.Description && (\n                i.Description.includes(vehicleNum) ||\n                i.Description.includes('טיפול') ||\n                i.Description.includes('עבודה')\n            )\n        );\n\n        if (item && item.Description) {\n            const desc = item.Description.trim();\n\n            // תיקון חדש: חפש דפוס \"טיפול XXX ק\\\"מ\" או \"טיפול XXX,XXX ק\\\"מ\"\n            // דפוס: \"טיפול\" + מספר (עם או בלי פסיק) + \"ק\\\"מ\" או \"קמ\"\n            const servicePattern = /טיפול\\s+[\\d,]+\\s*ק[״\"]?מ/i;\n            const match = desc.match(servicePattern);\n\n            if (match) {\n                // נמצא דפוס טיפול - נקה אותו ונחזיר\n                let serviceDesc = match[0];\n                // המר \"קמ\" ל-\"ק\\\"מ\" והסר פסיקים מהמספר\n                serviceDesc = serviceDesc\n                    .replace(/,/g, '')          // הסר פסיקים\n                    .replace(/קמ/g, 'ק\\\"מ')     // תקנן את \"קמ\" ל-\"ק\\\"מ\"\n                    .replace(/ק״מ/g, 'ק\\\"מ');  // תקנן את ״ ל-\\\"\n\n                return serviceDesc;\n            }\n\n            // אם לא נמצא דפוס טיפול - חפש תיאורים אחרים (החלפה, תיקון, בדיקה)\n            const generalPattern = /(החלפת|תיקון|בדיקת|הח[''׳])\\s+[\\u0590-\\u05FF\\s]+/;\n            const generalMatch = desc.match(generalPattern);\n\n            if (generalMatch) {\n                // קח עד 50 תווים מהתיאור\n                let shortDesc = generalMatch[0].trim();\n                if (shortDesc.length > 50) {\n                    shortDesc = shortDesc.substring(0, 47) + '...';\n                }\n                return shortDesc;\n            }\n\n            // אם אין דפוס מיוחד - קח את 3-4 המילים הראשונות\n            const words = desc.split(/\\s+/);\n            let shortDesc = words.slice(0, 4).join(' ');\n\n            if (shortDesc.length > 50) {\n                shortDesc = shortDesc.substring(0, 47) + '...';\n            }\n\n            return shortDesc;\n        }\n    }\n\n    // אם לא מצאנו תיאור - החזר ברירת מחדל\n    return 'טיפול';\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 4\n// ============================================================================\n\nfunction buildInvoiceFromTemplate(template, structure, config, searchResults, learnedConfig, ocrFields) {\n    const invoice = {\n        SUPNAME: config.supplier_config.supplier_code,\n        CODE: template.CODE,\n        DEBIT: structure.debit_type,\n        IVDATE: searchResults.ivdate,\n        BOOKNUM: searchResults.booknum\n    };\n\n    if (searchResults.ordname) {\n        invoice.ORDNAME = searchResults.ordname;\n    }\n\n    if (searchResults.impfnum) {\n        invoice.IMPFNUM = searchResults.impfnum;\n    }\n\n    // תיקון: DETAILS - יצירה חכמה לפי רכבים\n    if (searchResults.vehicles && searchResults.vehicles.length > 0) {\n        // אם יש רכבים - בנה DETAILS עם תיאור טיפול + ק\"מ נוכחי\n        const vehicleNum = searchResults.vehicles[0];\n        const shortDesc = extractShortDescription(ocrFields, vehicleNum);\n\n        // חיפוש ק\"מ נוכחי מה-UnidentifiedNumbers או CustomerId\n        let currentMileage = '';\n\n        // נסה למצוא ק\"מ ב-UnidentifiedNumbers\n        const unidentified = ocrFields.UnidentifiedNumbers || [];\n        if (unidentified.length > 0) {\n            const mileageItem = unidentified.find(item => {\n                if (typeof item === 'object') {\n                    const label = item.label || '';\n                    const value = item.value || '';\n                    // חפש תווית \"ק\\\"מ\" או מספר בין 50000-300000 (טווח סביר לק\"מ)\n                    if (label.includes('ק') || label.includes('קמ') || label.includes('מ')) {\n                        return /^\\d{5,6}$/.test(value);\n                    }\n                }\n                return false;\n            });\n\n            if (mileageItem && typeof mileageItem === 'object') {\n                currentMileage = mileageItem.value;\n            }\n        }\n\n        // אם לא נמצא, נסה CustomerId (לפעמים Azure מזהה את ק\"מ כ-CustomerId)\n        if (!currentMileage && ocrFields.CustomerId && /^\\d{5,6}$/.test(ocrFields.CustomerId)) {\n            currentMileage = ocrFields.CustomerId;\n        }\n\n        // בנה DETAILS לפי הפורמט: \"תיאור טיפול-XXXXXק\\\"מ\"\n        invoice.DETAILS = currentMileage ? `${shortDesc}-${currentMileage}` : shortDesc;\n    } else if (searchResults.details) {\n        // אחרת - השתמש ב-DETAILS הרגיל\n        invoice.DETAILS = searchResults.details;\n    }\n\n    // תעודות\n    if (searchResults.documents && searchResults.documents.length > 0) {\n        if (searchResults.documents.length === 1) {\n            invoice.DOCNO = searchResults.documents[0].DOCNO;\n        } else {\n            invoice.PIVDOC_SUBFORM = searchResults.documents.map(d => ({\n                DOCNO: d.DOCNO,\n                BOOKNUM: d.BOOKNUM\n            }));\n        }\n    }\n\n    // פריטים\n    const needItems = shouldAddItems(structure, searchResults.documents);\n\n    if (needItems) {\n        const vehicleRules = config.rules?.critical_patterns?.vehicle_rules;\n\n        // ✨ חדש! אם יש רכבים - יוצרים פריטי רכבים\n        if (searchResults.vehicles && searchResults.vehicles.length > 0 && vehicleRules) {\n            invoice.PINVOICEITEMS_SUBFORM = createVehicleItems(\n                searchResults.vehicles,\n                searchResults.items,\n                vehicleRules,\n                ocrFields  // תיקון: העברת ocrFields\n            );\n        }\n        // אחרת - פריטים רגילים מ-OCR\n        else if (searchResults.items && searchResults.items.length > 0) {\n            invoice.PINVOICEITEMS_SUBFORM = buildItems(\n                searchResults.items,\n                config,\n                structure,\n                template,\n                learnedConfig\n            );\n        }\n    }\n\n    if (template.PINVOICESCONT_SUBFORM) {\n        invoice.PINVOICESCONT_SUBFORM = template.PINVOICESCONT_SUBFORM;\n    }\n\n    return invoice;\n}\n\nfunction shouldAddItems(structure, documents) {\n    if (!structure.has_doc) return true;\n    if (structure.has_doc && (!documents || documents.length === 0)) return true;\n    if (structure.has_doc && structure.inventory_management === \"not_managed_inventory\") return true;\n    return false;\n}\n\nfunction buildItems(ocrItems, config, structure, template, learnedConfig) {\n    let defaultAccname = \"\";\n\n    if (template.PINVOICEITEMS_SUBFORM && template.PINVOICEITEMS_SUBFORM.length > 0) {\n        defaultAccname = template.PINVOICEITEMS_SUBFORM[0].ACCNAME || \"\";\n    }\n\n    if (!defaultAccname && config.document_types && config.document_types.length > 0) {\n        const docType = config.document_types[0];\n        if (docType.accnames && docType.accnames.length > 0) {\n            defaultAccname = docType.accnames[0];\n        }\n    }\n\n    let defaultBudcode = \"\";\n    if (template.PINVOICEITEMS_SUBFORM && template.PINVOICEITEMS_SUBFORM.length > 0) {\n        defaultBudcode = template.PINVOICEITEMS_SUBFORM[0].BUDCODE || \"\";\n    }\n\n    return ocrItems.map(ocrItem => {\n        const item = {\n            PARTNAME: extractPartname(ocrItem.ProductCode),\n            PDES: ocrItem.Description || \"\",\n            TQUANT: ocrItem.Quantity || 1,\n            TUNITNAME: ocrItem.Unit || \"יח'\",\n            PRICE: ocrItem.UnitPrice || ocrItem.UnitPrice_amount || 0,\n            VATFLAG: \"Y\",\n            ACCNAME: defaultAccname\n        };\n\n        if (item.PARTNAME === \"car\" && config.rules.critical_patterns.vehicle_rules) {\n            applyVehicleRules(item, ocrItem.Description, config.rules.critical_patterns.vehicle_rules);\n        }\n\n        if (config.rules.critical_patterns.partname_rules) {\n            applyPartnameRules(item, config.rules.critical_patterns.partname_rules);\n        }\n\n        if (structure.has_budcode && defaultBudcode) {\n            item.BUDCODE = defaultBudcode;\n        }\n\n        return item;\n    });\n}\n\nfunction extractPartname(productCode) {\n    if (!productCode) return \"\";\n\n    const codes = String(productCode).split('\\n');\n    const priorityCode = codes.find(c => /^[A-Z]/.test(c) || /^\\d+$/.test(c));\n\n    return priorityCode || codes[0] || \"\";\n}\n\nfunction applyVehicleRules(item, description, vehicleRules) {\n    if (!vehicleRules.vehicle_account_mapping) return;\n\n    const vehicleMatch = description.match(/\\d{3}-\\d{2}-\\d{3}/);\n    if (!vehicleMatch) return;\n\n    const vehicleNum = vehicleMatch[0];\n    const mapping = vehicleRules.vehicle_account_mapping[vehicleNum];\n\n    if (mapping) {\n        item.ACCNAME = mapping.accname;\n        item.VATFLAG = mapping.vat_pattern?.VATFLAG || mapping.vatflag || item.VATFLAG;\n\n        if (mapping.vat_pattern?.SPECIALVATFLAG && mapping.vat_pattern.SPECIALVATFLAG !== \"varies\") {\n            item.SPECIALVATFLAG = mapping.vat_pattern.SPECIALVATFLAG;\n        }\n\n        if (mapping.budcode) {\n            item.BUDCODE = mapping.budcode;\n        }\n    }\n}\n\nfunction applyPartnameRules(item, partnameRules) {\n    const rule = partnameRules[item.PARTNAME];\n\n    if (rule) {\n        if (rule.accname) item.ACCNAME = rule.accname;\n        if (rule.vatflag) item.VATFLAG = rule.vatflag;\n        if (rule.specialvatflag) item.SPECIALVATFLAG = rule.specialvatflag;\n    }\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 5 (בקרות)\n// ============================================================================\n\nfunction performValidation(invoice, ocrFields, config, docsList, patterns) {\n    const warnings = [];\n    const checks = {};\n\n    let invoiceTotquant = 0;\n    if (invoice.PINVOICEITEMS_SUBFORM) {\n        invoiceTotquant = invoice.PINVOICEITEMS_SUBFORM.reduce(\n            (sum, item) => sum + (item.TQUANT || 0),\n            0\n        );\n    }\n\n    let docsTotquant = 0;\n    if (docsList && docsList.list_of_docs) {\n        try {\n            const docs = docsList.list_of_docs.map(d => JSON.parse(d));\n            docsTotquant = docs.reduce((sum, d) => sum + (d.TOTQUANT || 0), 0);\n        } catch (e) {\n            // ממשיכים בלי\n        }\n    }\n\n    const learnedTotquant = config.rules.validation_data.TOTQUANT || 0;\n\n    checks.totquant = {\n        invoice_items_sum: invoiceTotquant,\n        docs_sum: docsTotquant,\n        learned_reference: learnedTotquant,\n        items_vs_docs_match: invoiceTotquant === docsTotquant || docsTotquant === 0,\n        notes: []\n    };\n\n    if (invoiceTotquant !== docsTotquant && docsTotquant > 0) {\n        warnings.push(`אי התאמת כמויות: פריטים=${invoiceTotquant}, תעודות=${docsTotquant}`);\n        checks.totquant.notes.push(\"אי התאמה בין פריטים לתעודות\");\n    }\n\n    if (patterns.booknum_pattern) {\n        const expected = patterns.booknum_pattern.length;\n        const actual = invoice.BOOKNUM.length;\n\n        checks.booknum_pattern = {\n            expected_length: expected,\n            actual_length: actual,\n            match: expected === actual,\n            pattern_example: patterns.booknum_pattern.example\n        };\n\n        if (expected !== actual) {\n            warnings.push(`דפוס BOOKNUM: צפוי ${expected} ספרות, קיבלנו ${actual}`);\n        }\n    }\n\n    const requiredFields = [\"SUPNAME\", \"CODE\", \"DEBIT\", \"IVDATE\", \"BOOKNUM\"];\n    const missingFields = requiredFields.filter(f => !invoice[f]);\n\n    if (missingFields.length > 0) {\n        warnings.push(`שדות חובה חסרים: ${missingFields.join(', ')}`);\n    }\n\n    if (invoice.PINVOICEITEMS_SUBFORM) {\n        const emptyAccounts = invoice.PINVOICEITEMS_SUBFORM.filter(\n            item => !item.ACCNAME || item.ACCNAME === \"\"\n        );\n\n        if (emptyAccounts.length > 0) {\n            warnings.push(`${emptyAccounts.length} פריטים ללא ACCNAME`);\n        }\n    }\n\n    return {\n        all_valid: warnings.length === 0,\n        checks: checks,\n        warnings: warnings\n    };\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 6 (למידה)\n// ============================================================================\n\nfunction analyzeLearning(invoice, config) {\n    const newPatterns = {\n        new_partnames: [],\n        new_vehicles: [],\n        unknown_accounts: []\n    };\n\n    const instructions = [];\n\n    if (invoice.PINVOICEITEMS_SUBFORM) {\n        invoice.PINVOICEITEMS_SUBFORM.forEach(item => {\n            const partnameKnown = config.rules.critical_patterns.partname_rules &&\n                                config.rules.critical_patterns.partname_rules[item.PARTNAME];\n\n            if (!partnameKnown && item.PARTNAME !== \"car\") {\n                newPatterns.new_partnames.push({\n                    partname: item.PARTNAME,\n                    pdes: item.PDES,\n                    suggested_accname: item.ACCNAME\n                });\n\n                instructions.push({\n                    type: \"add_partname_rule\",\n                    partname: item.PARTNAME,\n                    suggested_accname: item.ACCNAME,\n                    priority: \"medium\"\n                });\n            }\n\n            // ✨ חדש! זיהוי רכב חדש\n            if (item.PARTNAME === \"car\" || item.isNewVehicle) {\n                const vehicleMatch = item.PDES.match(/\\d{3}-\\d{2}-\\d{3}/);\n                if (vehicleMatch) {\n                    const vNum = vehicleMatch[0];\n                    const vehicleKnown = config.rules?.critical_patterns?.vehicle_rules?.vehicle_account_mapping?.[vNum];\n\n                    if (!vehicleKnown || item.isNewVehicle) {\n                        newPatterns.new_vehicles.push({\n                            vehicle_number: vNum,\n                            suggested_accname: item.ACCNAME,\n                            suggested_budcode: item.BUDCODE,\n                            suggested_vatflag: item.VATFLAG\n                        });\n\n                        instructions.push({\n                            type: \"add_vehicle_rule\",\n                            vehicle_number: vNum,\n                            suggested_accname: item.ACCNAME,\n                            suggested_budcode: item.BUDCODE,\n                            priority: \"high\"\n                        });\n                    }\n                }\n            }\n\n            if (!item.ACCNAME || item.ACCNAME === \"\") {\n                newPatterns.unknown_accounts.push({\n                    partname: item.PARTNAME,\n                    pdes: item.PDES\n                });\n\n                instructions.push({\n                    type: \"missing_account\",\n                    partname: item.PARTNAME,\n                    priority: \"critical\"\n                });\n            }\n        });\n    }\n\n    const learningRequired =\n        newPatterns.new_partnames.length > 0 ||\n        newPatterns.new_vehicles.length > 0 ||\n        newPatterns.unknown_accounts.length > 0;\n\n    return {\n        learning_required: learningRequired,\n        new_patterns: newPatterns,\n        learning_instructions: instructions,\n        recommendation: learningRequired ? \"שלח לקוד 3 ללמידה\" : \"אין צורך בלמידה\"\n    };\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 7 (יצירת פלטים נוספים)\n// ============================================================================\n\nfunction generateLLMPrompt(config, ocrFields, searchResults, executionReport) {\n    const supplierCode = config.supplier_config.supplier_code;\n    const supplierName = config.supplier_config.supplier_name;\n\n    // בניית הסבר על כל שדה\n    const fieldInstructions = {};\n\n    // BOOKNUM\n    fieldInstructions.booknum = {\n        field_name: \"BOOKNUM\",\n        description: \"מספר חשבונית\",\n        how_to_find: \"חפש בשדה InvoiceId ב-OCR. הסר קידומת SI אם קיימת. קח את מספר התווים האחרונים לפי הדפוס הנלמד.\",\n        example: searchResults.booknum || \"1015938\",\n        ocr_source: \"ocrFields.InvoiceId\"\n    };\n\n    // IVDATE\n    fieldInstructions.ivdate = {\n        field_name: \"IVDATE\",\n        description: \"תאריך חשבונית\",\n        how_to_find: \"קח את InvoiceDate מה-OCR והמר לפורמט DD/MM/YY\",\n        example: searchResults.ivdate || \"10/09/25\",\n        ocr_source: \"ocrFields.InvoiceDate\"\n    };\n\n    // PRICE - חשוב!\n    fieldInstructions.price = {\n        field_name: \"PRICE\",\n        description: \"מחיר לפני מע\\\"מ (עבודות + חלקים)\",\n        how_to_calculate: \"חשב: InvoiceTotal_amount - TotalTax_amount. זה נותן את סה\\\"כ החשבונית לפני מע\\\"מ.\",\n        formula: \"InvoiceTotal_amount - TotalTax_amount\",\n        example: ocrFields.InvoiceTotal_amount && ocrFields.TotalTax_amount\n            ? `${ocrFields.InvoiceTotal_amount} - ${ocrFields.TotalTax_amount} = ${ocrFields.InvoiceTotal_amount - ocrFields.TotalTax_amount}`\n            : \"2524 - 385.02 = 2138.98\",\n        fallback: \"אם אין TotalTax_amount, קח SubTotal_amount. אם גם זה לא קיים, קח InvoiceTotal_amount.\",\n        ocr_source: \"ocrFields.InvoiceTotal_amount, ocrFields.TotalTax_amount\"\n    };\n\n    // VEHICLES\n    const vehicleRules = config.rules?.critical_patterns?.vehicle_rules;\n    if (vehicleRules) {\n        fieldInstructions.vehicles = {\n            field_name: \"VEHICLES\",\n            description: \"מספרי רכבים\",\n            how_to_find: \"חפש פורמט XXX-XX-XXX ב-UnidentifiedNumbers עם label='רכב'. בדוק שזה לא מספר כרטיס (context לא מכיל 'כרטיס').\",\n            pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\",\n            example: searchResults.vehicles && searchResults.vehicles.length > 0\n                ? searchResults.vehicles.join(', ')\n                : \"459-06-303\",\n            ocr_source: \"ocrFields.UnidentifiedNumbers (with label filter)\"\n        };\n    }\n\n    // DETAILS\n    fieldInstructions.details = {\n        field_name: \"DETAILS\",\n        description: \"תיאור החשבונית\",\n        how_to_find: \"אם יש רכבים: חלץ תיאור קצר של השירות (3-4 מילים, מקסימום 50 תווים) מהפריט הראשון ב-Items. אם יש גם ק\\\"מ נוכחי (CustomerId), הוסף אותו בפורמט: 'תיאור-XXXXXק\\\"מ'\",\n        example: \"טיפול 75000 ק\\\"מ-76256\",\n        ocr_source: \"ocrFields.Items[0].Description, ocrFields.CustomerId\"\n    };\n\n    // מיפוי רכבים\n    const vehicleMapping = {};\n    if (vehicleRules && vehicleRules.vehicle_account_mapping) {\n        Object.keys(vehicleRules.vehicle_account_mapping).forEach(vNum => {\n            const mapping = vehicleRules.vehicle_account_mapping[vNum];\n            vehicleMapping[vNum] = {\n                account: mapping.accname,\n                budget_code: mapping.budcode,\n                vat_flag: mapping.vat_pattern?.VATFLAG || \"Y\",\n                description: mapping.accdes || `רכב ${vNum}`\n            };\n        });\n    }\n\n    return {\n        supplier_code: supplierCode,\n        supplier_name: supplierName,\n        document_type: \"חשבונית שירותי רכב\",\n        instructions: {\n            overview: `חשבונית מספק ${supplierName}. הספק מספק שירותי רכב ומוסך.`,\n            processing_steps: [\n                \"1. זהה את מספר החשבונית (BOOKNUM) מתוך InvoiceId\",\n                \"2. חשב את המחיר הכולל לפני מע\\\"מ: InvoiceTotal - TotalTax\",\n                \"3. חלץ מספרי רכבים מ-UnidentifiedNumbers (פורמט XXX-XX-XXX)\",\n                \"4. מפה כל רכב לחשבון הנכון לפי vehicle_mapping\",\n                \"5. צור תיאור קצר של השירות מהפריט הראשון\"\n            ],\n            fields: fieldInstructions,\n            vehicle_mapping: vehicleMapping\n        }\n    };\n}\n\nfunction generateTechnicalConfig(config, ocrFields, searchResults, executionReport) {\n    const supplierCode = config.supplier_config.supplier_code;\n    const supplierName = config.supplier_config.supplier_name;\n\n    // extraction rules מפורטים\n    const extractionRules = {};\n\n    // BOOKNUM\n    extractionRules.booknum = {\n        source: \"ocrFields.InvoiceId\",\n        transformations: [\n            {\n                action: \"remove_prefix\",\n                pattern: \"^SI\",\n                case_insensitive: true,\n                description: \"הסר קידומת SI אם קיימת\"\n            },\n            {\n                action: \"take_last_n_chars\",\n                count: 7,\n                description: \"קח 7 תווים אחרונים\"\n            }\n        ],\n        validation: {\n            length: 7,\n            pattern: \"^\\\\d{7}$\",\n            required: true\n        },\n        example: searchResults.booknum || \"1015938\"\n    };\n\n    // IVDATE\n    extractionRules.ivdate = {\n        source: \"ocrFields.InvoiceDate\",\n        format: \"DD/MM/YY\",\n        transformation: {\n            from: \"ISO8601\",\n            to: \"DD/MM/YY\",\n            description: \"המר מפורמט ISO (YYYY-MM-DD) לפורמט DD/MM/YY\"\n        },\n        validation: {\n            pattern: \"^\\\\d{2}/\\\\d{2}/\\\\d{2}$\",\n            required: true\n        },\n        example: searchResults.ivdate || \"10/09/25\"\n    };\n\n    // PRICE - החישוב החשוב!\n    extractionRules.price = {\n        calculation: {\n            method: \"subtract\",\n            primary: {\n                formula: \"ocrFields.InvoiceTotal_amount - ocrFields.TotalTax_amount\",\n                fields_required: [\"InvoiceTotal_amount\", \"TotalTax_amount\"],\n                description: \"סה\\\"כ לפני מע\\\"מ = סה\\\"כ כולל מע\\\"מ - מע\\\"מ\"\n            },\n            fallback: {\n                formula: \"ocrFields.SubTotal_amount || ocrFields.InvoiceTotal_amount\",\n                fields_required: [\"SubTotal_amount\"],\n                description: \"אם אין TotalTax_amount, קח SubTotal_amount\"\n            },\n            division_by_vehicles: {\n                enabled: true,\n                formula: \"totalPrice / vehicles.length\",\n                description: \"אם יש מספר רכבים, חלק את המחיר הכולל באופן שווה\"\n            }\n        },\n        description: \"מחיר לפני מע\\\"מ (עבודות + חלקים)\",\n        example_calculation: ocrFields.InvoiceTotal_amount && ocrFields.TotalTax_amount\n            ? {\n                invoice_total: ocrFields.InvoiceTotal_amount,\n                total_tax: ocrFields.TotalTax_amount,\n                calculated_price: ocrFields.InvoiceTotal_amount - ocrFields.TotalTax_amount,\n                formula_used: \"InvoiceTotal_amount - TotalTax_amount\"\n            }\n            : {\n                invoice_total: 2524,\n                total_tax: 385.02,\n                calculated_price: 2138.98,\n                formula_used: \"2524 - 385.02\"\n            }\n    };\n\n    // VEHICLES\n    const vehicleRules = config.rules?.critical_patterns?.vehicle_rules;\n    if (vehicleRules) {\n        extractionRules.vehicles = {\n            search_locations: [\n                {\n                    field: \"ocrFields.UnidentifiedNumbers\",\n                    priority: 1,\n                    filter: {\n                        label: \"רכב\",\n                        description: \"רק פריטים עם תווית 'רכב'\"\n                    },\n                    pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\",\n                    validation: {\n                        must_match_pattern: true,\n                        exclude_if_context_contains: [\"כרטיס\"],\n                        description: \"בדוק שזה לא מספר כרטיס\"\n                    }\n                },\n                {\n                    field: \"ocrFields.VehicleNumbers\",\n                    priority: 2,\n                    pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\"\n                },\n                {\n                    field: \"ocrFields.Items[].Description\",\n                    priority: 3,\n                    pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\",\n                    description: \"חפש בתיאור הפריטים\"\n                }\n            ],\n            example: searchResults.vehicles || [\"459-06-303\"]\n        };\n    }\n\n    // DESCRIPTION\n    extractionRules.description = {\n        source: \"ocrFields.Items[0].Description\",\n        extraction: {\n            method: \"pattern_match\",\n            patterns: [\n                {\n                    name: \"service_with_km\",\n                    pattern: \"טיפול\\\\s+[\\\\d,]+\\\\s*ק[״\\\"]?מ\",\n                    priority: 1,\n                    description: \"טיפול XXX ק\\\"מ\"\n                },\n                {\n                    name: \"general_service\",\n                    pattern: \"(החלפת|תיקון|בדיקת)\\\\s+[\\\\u0590-\\\\u05FF\\\\s]+\",\n                    priority: 2,\n                    description: \"תיאור כללי של שירות\"\n                }\n            ],\n            max_words: 4,\n            max_length: 50,\n            append_mileage: {\n                enabled: true,\n                source: \"ocrFields.CustomerId\",\n                format: \"{description}-{mileage}\",\n                description: \"אם יש ק\\\"מ נוכחי, הוסף בפורמט: 'תיאור-XXXXXק\\\"מ'\"\n            }\n        },\n        fallback: \"טיפול\",\n        example: \"טיפול 75000 ק\\\"מ\"\n    };\n\n    // Vehicle mapping\n    const vehicleMapping = {};\n    if (vehicleRules && vehicleRules.vehicle_account_mapping) {\n        Object.keys(vehicleRules.vehicle_account_mapping).forEach(vNum => {\n            const mapping = vehicleRules.vehicle_account_mapping[vNum];\n            vehicleMapping[vNum] = {\n                accname: mapping.accname,\n                accdes: mapping.accdes,\n                budcode: mapping.budcode,\n                vat_pattern: {\n                    VATFLAG: mapping.vat_pattern?.VATFLAG || \"Y\",\n                    SPECIALVATFLAG: mapping.vat_pattern?.SPECIALVATFLAG\n                },\n                date_range_pattern: mapping.date_range_pattern || \"never\",\n                pdaccname_pattern: mapping.pdaccname_pattern || \"never\"\n            };\n        });\n    }\n\n    // Template structure\n    const template = {\n        SUPNAME: supplierCode,\n        CODE: \"ש\\\"ח\",\n        DEBIT: \"D\",\n        TUNITNAME: \"יח'\",\n        TQUANT: 1,\n        PINVOICESCONT_SUBFORM: [\n            { FNCPATNAME: \"2323\" }\n        ]\n    };\n\n    return {\n        supplier_code: supplierCode,\n        supplier_name: supplierName,\n        version: \"4.2\",\n        document_type: \"vehicle_service_invoice\",\n        extraction_rules: extractionRules,\n        vehicle_mapping: vehicleMapping,\n        template: template,\n        validation_rules: {\n            required_fields: [\"SUPNAME\", \"CODE\", \"DEBIT\", \"IVDATE\", \"BOOKNUM\"],\n            booknum_length: 7,\n            totquant_check: {\n                enabled: true,\n                compare_with_docs: true,\n                learned_reference: config.rules.validation_data.TOTQUANT || 1\n            }\n        }\n    };\n}\n\n// ============================================================================\n// נקודת כניסה - רק אם input מוגדר (סביבת Azure Functions)\n// ============================================================================\n\nif (typeof input !== 'undefined') {\n    const processInput = {\n        learned_config: input.learned_config,\n        docs_list: input.docs_list,\n        import_files: input.import_files,\n        AZURE_RESULT: input.AZURE_RESULT,\n        AZURE_TEXT: input.AZURE_TEXT\n    };\n\n    const result = processInvoiceComplete(processInput);\n\n    console.log(JSON.stringify(result));\n    return result;\n}\n\n// ============================================================================\n// ייצוא פונקציות למודול\n// ============================================================================\nmodule.exports = {\n    processInvoiceComplete\n};"
    }
]
